
// @fileRef create_proposal.js 
var payment_details_submit=true;var get_premium='';var total_premium=0;var apply_onload=0;var proposal_created=0;var show_popup=0;var show_popup_new=0;var famconsCount=0;var memberCount=0;var deletecalled=0;var proposal_payment_done=0;var TELE_HEALTHPROINFINITY_GHI='473';var TELE_HEALTHPROINFINITY_GPA='474';var TELE_HEALTHPROINFINITY_GHI_GPA='473,474';var TELE_HEALTHPROINFINITY_GHI_ST='475';var TELE_HEALTHPROINFINITY_PRODUCT_NAME='Tele - Health Pro Infinity';var membersCovered=[];var is_self_purchased=0;var self_purcased_with_si=0;function ajaxindicatorstart(text){text=typeof text!=="undefined"?text:"We are quickly gathering your information to get you started";var res="";if($("body").find("#resultLoading").attr("id")!="resultLoading"){res+="<div id='resultLoading' style='display: none'>";res+="<div id='resultcontent'>";res+="<div id='ajaxloader' class='txt'>";res+='<svg class="lds-curve-bars" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><g transform="translate(50,50)"><circle cx="0" cy="0" r="8.333333333333334" fill="none" stroke="#861F41" stroke-width="4" stroke-dasharray="26.179938779914945 26.179938779914945" transform="rotate(2.72337)"><animateTransform attributeName="transform" type="rotate" values="0 0 0;360 0 0" times="0;1" dur="1s" calcMode="spline" keySplines="0.2 0 0.8 1" begin="0" repeatCount="indefinite"></animateTransform></circle><circle cx="0" cy="0" r="16.666666666666668" fill="none" stroke="#861F41" stroke-width="4" stroke-dasharray="52.35987755982989 52.35987755982989" transform="rotate(64.7343)"><animateTransform attributeName="transform" type="rotate" values="0 0 0;360 0 0" times="0;1" dur="1s" calcMode="spline" keySplines="0.2 0 0.8 1" begin="-0.2" repeatCount="indefinite"></animateTransform></circle><circle cx="0" cy="0" r="25" fill="none" stroke="#ffffff" stroke-width="4" stroke-dasharray="78.53981633974483 78.53981633974483" transform="rotate(150.07)"><animateTransform attributeName="transform" type="rotate" values="0 0 0;360 0 0" times="0;1" dur="1s" calcMode="spline" keySplines="0.2 0 0.8 1" begin="-0.4" repeatCount="indefinite"></animateTransform></circle><circle cx="0" cy="0" r="33.333333333333336" fill="none" stroke="#861F41" stroke-width="4" stroke-dasharray="104.71975511965978 104.71975511965978" transform="rotate(239.433)"><animateTransform attributeName="transform" type="rotate" values="0 0 0;360 0 0" times="0;1" dur="1s" calcMode="spline" keySplines="0.2 0 0.8 1" begin="-0.6" repeatCount="indefinite"></animateTransform></circle><circle cx="0" cy="0" r="41.666666666666664" fill="none" stroke="#861F41" stroke-width="4" stroke-dasharray="130.89969389957471 130.89969389957471" transform="rotate(320.34)"><animateTransform attributeName="transform" type="rotate" values="0 0 0;360 0 0" times="0;1" dur="1s" calcMode="spline" keySplines="0.2 0 0.8 1" begin="-0.8" repeatCount="indefinite"></animateTransform></circle></g></svg>';res+="<br/>";res+="<span id='loadingMsg'></span>";res+="</div>";res+="</div>";res+="</div>";$("body").append(res);}
$("#loadingMsg").html(text);$("#resultLoading").find("#resultcontent > #ajaxloader").css({position:"absolute",width:"500px",height:"75px",});$("#resultLoading").css({width:"100%",height:"100%",position:"fixed","z-index":"10000000",top:"0",left:"0",right:"0",bottom:"0",margin:"auto",});$("#resultLoading").find("#resultcontent").css({background:"#ffffff",opacity:"0.7",width:"100%",height:"100%","text-align":"center","vertical-align":"middle",position:"fixed",top:"0",left:"0",right:"0",bottom:"0",margin:"auto","font-size":"16px","z-index":"10",color:"#000000",});$("#resultLoading").find(".txt").css({position:"absolute",top:"-25%",bottom:"0",left:"0",right:"0",margin:"auto",});$("#resultLoading").fadeIn(300);$("body").css("cursor","wait");}
function ajaxindicatorstop(){$("#resultLoading").fadeOut(300);$("body").css("cursor","default");}
$(window).on('load',function(){var boxlen=$('.commonCls').length;if(boxlen>0){$("#plan_name").attr('disabled','disabled');if($('#plan_name').val()=='T03'){$("#sum_insures").attr('disabled','disabled');$("#patFamilyConstruct").attr('disabled','disabled');}}})
function set_session(){$.ajax({url:"/tele_set_session",type:"POST",data:{"lead_id":$('#hidden_lead_id').val()},async:false,dataType:"json",success:function(response){}});}
function unique(array){return array.filter(function(el,index,arr){return index==arr.indexOf(el);});}
$(document).on("keyup",".textAreaGHD",function()
{var desc=$(this).val();var lastChar=desc.slice(-1);var spc=(!((lastChar.charCodeAt()>=48&&lastChar.charCodeAt()<=57)||(lastChar.charCodeAt()>=65&&lastChar.charCodeAt()<=90)||(lastChar.charCodeAt()>=97&&lastChar.charCodeAt()<=122))||(!(lastChar.charCodeAt()==44)));if(spc)
{var rp=this.value.replace(/[&!@^_=\/\\#+{}|[\]()$~%.'":;*?<>]/g,"");$(this).val(rp);}});function findCommonElements3(arr1,arr2){return arr1.some(item=>arr2.includes(item))}
$("#famConSelected").validate({ignore:".ignore",rules:{spouse_rel:{required:true},spouse_date_birth:{required:true},kid1_rel:{required:true},kid1_date_birth:{required:true},kid2_rel:{required:true},kid2_date_birth:{required:true},},messages:{},submitHandler:function(form){var form=$("#famConSelected").serialize()+"&empId="+$('#empidaxistele').val()+"&family_construct="+$("#patFamilyConstruct").val()+"&adult_selected="+$('input[name="adult_fr_id"]:checked').val()+"&sum_insures="+$("#sum_insures").val();$.post("/tele/store_family_dobs",form,function(e){e=JSON.parse(e);if(e.message!='true'){swal("Alert",e.message);}else{$('#helathproXlFamilyModal').modal("hide");$('#helathproXl').html(e.html);if($('#plan_name').val()=="T03"){$("#helathproXlModal").modal("show");}else if($('#plan_name').val()=="T01"){var family_construct=$('#patFamilyConstruct option:selected').val();var result=family_construct.split('+');var add_length=[];add_length.push(parseInt(result[0]));add_length.push(parseInt(result[1]));if(!$('#patFamilyConstruct').is('[disabled=disabled]')){var boxlen=$('.commonCls').length;var icount;if(boxlen==''){icount=0}else{icount=0+boxlen;}
for(i=icount;i<sum(add_length);i++){common_append(i);}
$("#add_btn_view").show();getPremiumNew();}}
membersCovered=e.membersCovered;getRelation();}});}});$(document).ready(function()
{hideEditButtons();$("body").delegate("#spouse_date_birth","focusin",function(){$(this).datepicker({dateFormat:"dd-mm-yy",prevText:'<i class="fa fa-angle-left"></i>',nextText:'<i class="fa fa-angle-right"></i>',changeMonth:true,changeYear:true,yearRange:"-100Y:-18Y",maxDate:"-18Y",minDate:"-56Y +1D",});});$("#kid2_date_birth").datepicker({dateFormat:"dd-mm-yy",prevText:'<i class="fa fa-angle-left"></i>',nextText:'<i class="fa fa-angle-right"></i>',changeMonth:true,changeYear:true,maxDate:0,yearRange:"-100: +0",onSelect:function(dateText,inst){}});$("#kid1_date_birth").datepicker({dateFormat:"dd-mm-yy",prevText:'<i class="fa fa-angle-left"></i>',nextText:'<i class="fa fa-angle-right"></i>',changeMonth:true,changeYear:true,maxDate:0,yearRange:"-100: +0",onSelect:function(dateText,inst){}});$(document).on("click",".validateFamCons",function(){var cons=$('#patFamilyConstruct').val().split("+");if(cons[0]=='1A'){if($('input[name="adult_fr_id"]:checked').val()==undefined){swal("Alert","Please Select Adult","warning");return false;}else{if($('input[name="adult_fr_id"]:checked').val()==0){$('#spouse_rel').addClass('ignore');$('#spouse_date_birth').addClass('ignore');}else{$('#spouse_rel').removeClass('ignore');$('#spouse_date_birth').removeClass('ignore');}}}else{$('#spouse_rel').removeClass('ignore');$('#spouse_date_birth').removeClass('ignore');}
if(cons[1]!=undefined){if(cons[1]=='1K'){$('#kid2_rel').addClass('ignore');$('#kid2_date_birth').addClass('ignore');$('#kid1_rel').removeClass('ignore');$('#kid1_date_birth').removeClass('ignore');}else{$('#kid1_rel').removeClass('ignore');$('#kid1_date_birth').removeClass('ignore');$('#kid2_rel').removeClass('ignore');$('#kid2_date_birth').removeClass('ignore');}}else{$('#kid1_rel').addClass('ignore');$('#kid1_date_birth').addClass('ignore');$('#kid2_rel').addClass('ignore');$('#kid2_date_birth').addClass('ignore');}})
$(document).on("click",".xlmodalvalidate",function(){if($('input[name="policy_selection"]:checked').val()==undefined){swal("Alert","Please Select Plan","warning");}else{var premium=$('input[name="policy_selection"]:checked').data('premium');var deductable=$('input[name="policy_selection"]:checked').data('deductable');var policy_detail_id=$('input[name="policy_selection"]:checked').val();$('#premium').val(premium);$('#helathproXlModal').modal("hide");$('#hidden_deductable').val(deductable);$('#hidden_policy_id').val(policy_detail_id);if(policy_detail_id==TELE_HEALTHPROINFINITY_GHI_GPA){$('.occupation_label').show();$('#occupation').removeClass('ignore');$("#annual_income_label").show();$.ajax({url:"tele_gpa_policy_purchased_for_self",type:"POST",async:false,dataType:"json",success:function(response){if($("#plan_name").val()=='T01'||$("#plan_name").val()=='T03'){if(response.flag){is_self_purchased=response.flag;self_purcased_with_si=response.sum_insure;}
if(is_self_purchased==1){$('#occupation').addClass('ignore');$('#annual_income').addClass('ignore');}}}});annual_income_hide_show();}else{$('.occupation_label').hide();$('#occupation').addClass('ignore');$("#annual_income_label").hide();annual_income_hide_show();}
if($('.commonCls').length>0){apply_button();console.log('---->'+deletecalled);if(deletecalled==0){if(famconsCount>=memberCount){swal("Alert","Below Member Details Section would get modified or deleted. Press OK to Proceed","warning");}else{famconsCount++;}}else{deletecalled=0;}}
var family_construct=$('#patFamilyConstruct option:selected').val();var result=family_construct.split('+');var add_length=[];add_length.push(parseInt(result[0]));add_length.push(parseInt(result[1]));if(!$('#patFamilyConstruct').is('[disabled=disabled]')){var boxlen=$('.commonCls').length;var icount;if(boxlen==''){icount=0}else{icount=0+boxlen;}
for(i=icount;i<sum(add_length);i++){common_append(i);}
$("#add_btn_view").show();}
if($("#plan_name").val()=='T03'){getPremiumNew();}}})
$("input[name='adult_fr_id']").click(function(){var cons=$("#patFamilyConstruct").val().split("+");if(cons[0]=='1A'){if($('input[name="adult_fr_id"]:checked').val()==1){$(".spouse_div").show();}else{$(".spouse_div").hide();}
$(".check_adult").show();}else{$(".spouse_div").show();$(".check_adult").hide();}
if(cons[1]!=undefined){if(cons[1]=='1K'){$('.kid1_div').show();}else{$('.kid1_div').show();$('.kid2_div').show();}}else{$('.kid1_div').hide();$('.kid2_div').hide();}})
$(document).on("change","#salutation",function(){if($(this).val()==1){$('#gender1').val('Male');}else{$('#gender1').val('Female');}})
$(document).on("click",".rd_ghd_mem",function(){var radio_val=$(this).val();var radio_name=$(this).attr("name");var text_name=radio_name.replace("radio","text");if(radio_val=='yes'){$("."+text_name).show();$("."+text_name).prop('required',true);}else{$("."+text_name).hide();$("."+text_name).val('');$("."+text_name).prop('required',false);}});$(document).on("click","#edit_payment",function(){$("#edit_payment").hide();$("#sub_isposition").attr("disabled",false);$("#disposition").attr("disabled",false);})
$(document).on("click","#edit_nominee",function(){$('#edit_nominee').hide();$('#nominee_relation').attr('disabled',false);$('#nominee_fname').attr('readonly',false);$('#nominee_lname').attr('readonly',false);$('#nominee_salutation').attr('disabled',false);$('#nominee_gender').attr('readonly',false);$('#nomineedob').attr('readonly',false);$('#nomineedob').attr('disabled',false);$('#nominee_contact').attr('readonly',false);$('#nominee_email').attr('readonly',false);get_fam_data();})
$(document).on("click","#edit_btn_custsection",function(){$('#edit_btn_custsection').hide();$('#update_emp').show();$('#firstname').focus();console.log(proposal_created);if(proposal_created==1){$('#firstname').attr('readonly',false);$('#lastname').attr('readonly',false);$('#salutation').attr('disabled',false);$('#comAdd').attr('readonly',false);$('#comAdd2').attr('readonly',false);$('#comAdd3').attr('readonly',false);$('#pin_code').attr('readonly',false);$('#mobile_no2').attr('disabled',false);$('#email').attr('disabled',false);}else{$('#salutation').attr('disabled',false);$('#firstname').attr('readonly',false);$('#lastname').attr('readonly',false);$('#dob1').attr('disabled',false);$('#dob1').attr('readonly',false);$('#comAdd').attr('readonly',false);$('#comAdd2').attr('readonly',false);$('#comAdd3').attr('readonly',false);$('#pin_code').attr('readonly',false);}})
$(document).on("change","#sub_isposition",function(){var z=$(this);enable_disable_proposal(z);});$(document).on("change","#disposition",function(){var z=$(this);get_sub_disposition(z);});$(document).on("change","#occupation",function(){var plan_name=$("#plan_name").val();if(plan_name=='T03'){$.ajax({url:"/tele_verify_occupation",type:"POST",data:{"occupation_id":$(this).val()},async:false,dataType:"json",success:function(response){if(response.status=='error'){$("#occupation")[0].selectedIndex=0;swal("Alert","Occupation not allowed ","warning");}}});}})
$("#patFormSubmit").on("click",function(){return annual_income_logic();})
$.validator.addMethod("notEqual",function(value,element,param){if(value!=2&&value!=3){return this.optional(element)||$(param).not(element).get().every(function(item){return $(item).val()!=value;});}else{return true;}},"Please select different member");$.validator.addClassRules("family_members_id1",{notEqual:".family_members_id1"});$.validator.addMethod("notEqual1",function(value,element,param){if(value!=2&&value!=3){return this.optional(element)||$(param).not(element).get().every(function(item){return $(item).val()!=value;});}else{return true;}},"Please enter different mobile number");$.validator.addClassRules("mem_mob_no1",{valid_mobile:"true",});$.validator.addClassRules("mem_email_id1",{validateEmail:"true"});$('body').on("keyup","#avName,#agent_name,#tl_name,#am_name,#om_name,#firstname,#lastname,.first_name1,.last_name1,#nominee_fname,#nominee_lname",function(){if($(this).val().match(/[^a-zA-Z ]/g)){$(this).val($(this).val().replace(/[^a-zA-Z ]/g,""));}
$(this).val($(this).val().toUpperCase());});$('body').on("keyup",".first_name,.last_name,.lastname",function(){if($(this).val().match(/[^a-zA-Z ]/g)){$(this).val($(this).val().replace(/[^a-zA-Z ]/g,""));}
$(this).val($(this).val().toUpperCase());});$('.bd-example-modal-md').removeClass('hide');var selectChange="";var emp_id=$("#empIdHidden").val()||"";var parent_ids=$("#parentIdHidden").val();$.ajax({url:"/tele_master_salutation",type:"POST",async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response)
{$("#salutation").empty();$("#salutation").append("<option value = ''>Select salutation</option>");for(i=0;i<response.length;i++)
{$("#salutation").append("<option  value ="+response[i]['s_id']+">"+response[i]['salutation']+"</option>");}}});$.ajax({url:"/tele_axis_location",type:"POST",async:false,dataType:"json",success:function(response)
{$("#axis_location").empty();$("#axis_location").append("<option value = ''>Select Axis Location</option>");for(i=0;i<response.length;i++)
{$("#axis_location").append("<option  value ="+response[i]['axis_loc_id']+">"+response[i]['axis_location']+"</option>");}}});$.ajax({url:"/tele_employee_data",type:"POST",async:false,data:{},dataType:"json",success:function(response)
{if(response.email=='')
{$("#email").attr("readonly",false);}
if(response.emp_pincode==''||response.emp_pincode=='.')
{$("#pin_code").attr("readonly",false);}
$("#firstname").val(response.emp_firstname.toUpperCase());$("#lastname").val(response.emp_lastname.toUpperCase());$("#panCard").val(response.pancard);$("#annual_income").val(response.annual_income);$("#occupation").val(response.occupation);try{$("#addCard").val(response.adhar);}catch(e){}
$("#lead_id_product").html(response.lead_id);$("#lead_id").val(response.lead_id);$("#comAdd").val(response.address);$("#hidden_policy_id").val(response.pid);$("#hidden_deductable").val(response.deductable);$("#gender1").val(response.gender);$("#dob1").val(response.bdate);$("#dob1").attr('disabled','disabled');$("#mob_no").val(response.mob_no);$("#email").val(response.email);$("#saksham_id").val(response.saksham_id);$("#salutation option").filter(function(){return $(this).text()===response.salutation?$(this).prop("selected",true):false;});$("#pin_code").val(response.emp_pincode);$("#city").val(response.emp_city);$("#state").val(response.emp_state);if(response.ISNRI=='Y')
{$("#comAdd").attr("readonly",false);}
if(response.address!=null&&response.emp_pincode!=null){$('#hidden_customer_section').val(1);}}});$("#dob").datepicker({dateFormat:"dd-mm-yy",prevText:'<i class="fa fa-angle-left"></i>',nextText:'<i class="fa fa-angle-right"></i>',changeMonth:true,changeYear:true,yearRange:"-100Y:-18Y",maxDate:"-18Y",});$("#dob1").datepicker({dateFormat:"dd-mm-yy",prevText:'<i class="fa fa-angle-left"></i>',nextText:'<i class="fa fa-angle-right"></i>',changeMonth:true,changeYear:true,yearRange:"-100Y:-18Y",maxDate:"-18Y",minDate:"-56Y +1D"});$("#nomineedob").datepicker({dateFormat:"dd-mm-yy",prevText:'<i class="fa fa-angle-left"></i>',nextText:'<i class="fa fa-angle-right"></i>',changeMonth:true,changeYear:true,yearRange:"-100Y:-0Y",maxDate:"-0Y",});$('#preferred_contact_time').timepicker({timeFormat:'h:i p',showInputs:false,showMeridian:false,minuteStep:1,defaultTime:null,});$.ajax({url:"/tele_agent_details",type:"POST",async:false,dataType:"json",success:function(response)
{$("#avCode").val(response.agent_id);$("#avName").val(response.agent_name.toUpperCase());}});$.ajax({url:"/tele_master_nominee",type:"POST",async:false,dataType:"json",success:function(response)
{$("#nominee_relation").empty();$("#nominee_relation").append("<option value = ''>Select Nominee</option>");for(i=0;i<response.length;i++)
{$("#nominee_relation").append("<option  data-opt = "+response[i]['gender']+" value ="+response[i]['nominee_id']+">"+response[i]['nominee_type']+"</option>");}}});$("#plan_name").on("change",function(){if($('#plan_name').val()!=''){var product_name=$(this).find("option:selected").text();$("#pr_name").html(product_name);$("#pr_name").html('Axis Tele Inbound Affinity Portal for ABHI');$.ajax({url:"tele_update_ref_no",type:"POST",async:false,data:{product_id:$('#plan_name').val()},dataType:"json",success:function(response){}});$.ajax({url:"tele_gpa_policy_purchased_for_self",type:"POST",async:false,dataType:"json",success:function(response){debugger;if($("#plan_name").val()=='T01'||$("#plan_name").val()=='T03'){if(response.flag){is_self_purchased=response.flag;self_purcased_with_si=response.sum_insure;}
if(is_self_purchased==1){$('#occupation').addClass('ignore');$('#annual_income').addClass('ignore');}}}});}
$('#occupation').prop('selectedIndex',0);$.ajax({url:"/tele_get_declaration",type:"POST",data:{product_id:$('#plan_name').val()},success:function(data)
{if(data!='')
{var data=JSON.parse(data);var ghd_content=$('#ghd-table').html();if(product_id=='R06'||product_id=='T01'||product_id=='T03'){data.ghd.replace('/&lt;/g','<').replace('/&gt;/g','>');$('#policy_declare_new').html(data.ghd);$('.myremark').val('');$('.myremark').hide();}else{$('#ghd-table').html(ghd_content);$('.myremark').show();}
$('#health_declare').show();$('#policy_declare').html(data.employee_declaration);}}});$(".sub_isposition").trigger('change');if($(this).val()=='T01'){$('.GCIOptionalDiv').show();}else{$('.GCIOptionalDiv').hide();}
var product_id=$(this).val();$.ajax({url:"/tele_suminsured_data",type:"POST",data:{product_id:product_id},async:false,dataType:"json",success:function(response)
{if(response.length!=""){$("#sum_insure").empty();$("#sum_insures").empty();$("#sum_insure").append("<option value = ''>Select Sum insured</option>");$("#sum_insures").append("<option value = ''>Select Sum insured</option>");var arr=[];for(i=0;i<response.length;++i){if(response[i].flate){response[i].flate.forEach(function(e){var sumInsured=e["sum_insured"].split(",");var PremiumServiceTax=e["PremiumServiceTax"].split(",");setMasPolicy("flate",e);});}
if(response[i].family_construct){response[i].family_construct.forEach(function(e){if(e['combo_flag']=='Y'){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);setMasPolicy("family_construct",e);}else{}}
else{setMasPolicy("family_construct",e);}});}
if(response[i].family_construct_age){response[i].family_construct_age.forEach(function(e){if(e['combo_flag']=='Y'){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);setMasPolicy("family_construct_age",e);}else{}}
else{setMasPolicy("family_construct_age",e);}});}
var policyid=[];if(response[i].combo_diff_construct){response[i].combo_diff_construct.forEach(function(e){debugger;if(product_id!="T01"){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);policyid.push(e['policy_sub_type_id']);setMasPolicy("family_construct",e);}else{if(!policyid.includes(e['policy_sub_type_id'])){setMasPolicy("combo_diff_construct",e);}}}else{if(e['combo_flag']=='Y'){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);policyid.push(e['policy_sub_type_id']);setMasPolicy("combo_diff_construct",e);}else{if(!policyid.includes(e['policy_sub_type_id'])){setMasPolicy("combo_diff_construct",e);}}}}});}
if(response[i].memberAge){response[i].memberAge.forEach(function(e){if(e['combo_flag']=='Y'){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);setMasPolicy("memberAge",e);}else{}}
else{setMasPolicy("memberAge",e);}});}}}
get_all_data();}});})
$.ajax({url:"/tele_policy_data_new",type:"POST",data:{},async:false,dataType:"json",success:function(response){$("#benifit_4s").css("display","block");$("#plan_name").html(response);}});$.ajax({url:"/tele_policy_data",type:"POST",data:{},async:false,dataType:"json",success:function(response)
{$("#benifit_4s").css("display","block");var i;for(i=0;i<response.length;i++)
{$("#pr_name").html(response[i].product_name);$("#pr_name").html('Axis Tele Inbound Affinity Portal for ABHI');$("#plan_name").val(response[i].product_code);$("#master_policy_number").val(response[i].master_policy_no);if(response[i].policy_sub_type_id==1)
{$(".personal_accident").text(response[i].policy_sub_type_name);$("#benifit_4s").css("display","block");$("#subtype_text").val(response[i].policy_sub_type_id);if((response[i].max_adult>1&&response[i].fr_id==1)||response[i].fr_id==0)
{$("#family_members_id"+i).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}
else if(response[i].max_adult==2&&response[i].max_child==0&&(response[i].fr_id==4||response[i].fr_id==5||response[i].fr_id==6||response[i].fr_id==7))
{$("#family_members_id"+i).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}
else if(response[i].max_adult==4&&response[i].max_child==0&&response[i].fr_id==5||response[i].fr_id==6||response[i].fr_id==7)
{$("#family_members_id"+i).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}
else if(response[i].max_adult>2&&(response[i].fr_id==4||response[i].fr_id==5||response[i].fr_id==6||response[i].fr_id==7||response[i].fr_id==1||response[i].fr_id==0))
{$("#family_members_id"+i).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}
else if(response[i].fr_id==2||response[i].fr_id==3)
{$("#family_members_id"+i).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}}}}});$.ajax({url:"tele_gpa_policy_purchased_for_self",type:"POST",async:false,dataType:"json",success:function(response){debugger;if($("#plan_name").val()=='T01'||$("#plan_name").val()=='T03'){if(response.flag){is_self_purchased=response.flag;self_purcased_with_si=response.sum_insure;}
if(is_self_purchased==1){$('#occupation').addClass('ignore');$('#annual_income').addClass('ignore');}}}});$.ajax({url:"/tele_get_declaration",type:"POST",data:{product_id:$('#plan_name').val()},success:function(data)
{if(data!='')
{var data=JSON.parse(data);var ghd_content=$('#ghd-table').html();data.ghd.replace(/&lt;/g,'<').replace(/&gt;/g,'>');if(product_id=='R06'||product_id=='T01'||product_id=='T03'){$('#policy_declare_new').html(data.ghd);$('.myremark').val('');$('.myremark').hide();}else{$('#ghd-table').html(ghd_content);$('.myremark').show();}
$('#health_declare').show();$('#policy_declare').html(data.employee_declaration);}}});var product_id=$('#plan_name').val();if(product_id!=''||product_id!=null){$.ajax({url:"/tele_suminsured_data",type:"POST",data:{product_id:product_id},async:false,dataType:"json",success:function(response)
{if(response.length!=""){$("#sum_insure").empty();$("#sum_insures").empty();$("#sum_insure").append("<option value = ''>Select Sum insured</option>");$("#sum_insures").append("<option value = ''>Select Sum insured</option>");var arr=[];for(i=0;i<response.length;++i){if(response[i].flate){response[i].flate.forEach(function(e){var sumInsured=e["sum_insured"].split(",");var PremiumServiceTax=e["PremiumServiceTax"].split(",");setMasPolicy("flate",e);});}
if(response[i].family_construct){response[i].family_construct.forEach(function(e){if(e['combo_flag']=='Y'){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);setMasPolicy("family_construct",e);}else{}}
else{setMasPolicy("family_construct",e);}});}
if(response[i].family_construct_age){response[i].family_construct_age.forEach(function(e){if(e['combo_flag']=='Y'){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);setMasPolicy("family_construct_age",e);}else{}}
else{setMasPolicy("family_construct_age",e);}});}
var policyid=[];if(response[i].combo_diff_construct){response[i].combo_diff_construct.forEach(function(e){if(product_id!="T01"){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);policyid.push(e['policy_sub_type_id']);setMasPolicy("family_construct",e);}else{if(!policyid.includes(e['policy_sub_type_id'])){setMasPolicy("combo_diff_construct",e);}}}else{if(e['combo_flag']=='Y'){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);policyid.push(e['policy_sub_type_id']);setMasPolicy("combo_diff_construct",e);}else{if(!policyid.includes(e['policy_sub_type_id'])){setMasPolicy("combo_diff_construct",e);}}}}});}
if(response[i].memberAge){response[i].memberAge.forEach(function(e){if(e['combo_flag']=='Y'){if(!arr.includes(e['sum_insured'])){arr.push(e['sum_insured']);setMasPolicy("memberAge",e);}else{}}
else{setMasPolicy("memberAge",e);}});}}}
get_all_data();}});}});$(document).on("change","#axis_location",function()
{var axis_loc=$(this).val();$.ajax({url:"/tele_axis_vendor",type:"POST",async:false,data:{'axis_loc':axis_loc},dataType:"json",success:function(response)
{$("#axis_vendor").empty();$("#axis_vendor").append("<option value = ''>Select Axis Vendor</option>");for(i=0;i<response.length;i++)
{$("#axis_vendor").append("<option  value ="+response[i]['axis_vendor_id']+">"+response[i]['axis_vendor']+"</option>");}}});});$(document).on("change","select[name='sum_insure']",function()
{if($('#plan_name').val()){$.ajax({url:"tele_update_ref_no",type:"POST",async:false,data:{product_id:$('#plan_name').val()},dataType:"json",success:function(response){}});}
apply_button();selectChange=$(this).closest("form");var tax_with_premium=selectChange.find('select[name=sum_insure] option:selected').data("id");var select_sum_insured=selectChange.find('select[name=sum_insure] :selected');selectChange.find('select[name=familyConstruct]').empty();if(select_sum_insured.val()=='')
{selectChange.find('select[name=familyConstruct]').html('<option value="" selected>Select</option>');}
if(select_sum_insured.attr("data-type")=="family_construct"||select_sum_insured.attr("data-type")=="family_construct_age"||select_sum_insured.attr("data-type")=="combo_diff_construct")
{$("select[name=familyConstruct]").empty();$("select[name=familyConstruct]").html('<option value="" selected>Select</option>');$.post("/tele_family_construct",{"policyNo":select_sum_insured.attr("data-policyno"),"sumInsured":select_sum_insured.val(),"table":select_sum_insured.attr("data-type"),},function(e)
{selectChange.find('select[name=familyConstruct]').empty();e=JSON.parse(e);if(e.status=='error'){swal("error",e.msg,"warning");}else{e=e.data;if(e)
{$("select[name=familyConstruct]").html('<option value="" selected>Select</option>');e.forEach(function(e1)
{selectChange.find('select[name=familyConstruct]').append("<option value='"+e1.family_type+"' data-premium='"+e1.PremiumServiceTax+"'>"+e1.family_type+"</option>");});}
$("#patFamilyConstructDiv").show();if($('#plan_name').val()!='T03'){if(select_sum_insured.val()>1000000){$("#annual_income_label").show();$("#occupation_label").show();$("#annual_income").removeClass("ignore");$("#occupation").removeClass("ignore");}else{$("#annual_income_label").hide();$("#occupation_label").hide();$("#annual_income").addClass("ignore");$("#occupation").addClass("ignore");}}}});}else if(select_sum_insured.attr("data-type")=="memberAge"){$("select[name=familyConstruct]").empty();$("select[name=familyConstruct]").html('<option value="" selected="">Select</option><option value="1A">1A</option><option value="2A">2A</option>');$("#patFamilyConstructDiv").show();if(select_sum_insured.val()>1000000){$("#annual_income_label").show();$("#occupation_label").show();$("#annual_income").removeClass("ignore");$("#occupation").removeClass("ignore");}else{$("#occupation_label").show();$("#annual_income_label").hide();$("#occupation_label").hide();$("#annual_income").addClass("ignore");$("#occupation").addClass("ignore");}}
if($('select[name=sum_insure]').val()!=''&&$('select[name=sum_insure] :selected').attr("data-policyno")!=''&&$('select[name=familyConstruct]').val()!=''&&$('#plan_name').val()!=''){$.post("/tele_get_premium",{"sum_insured":$('select[name=sum_insure]').val(),"policy_detail_id":$('select[name=sum_insure] :selected').attr("data-policyno"),"deductable":$('#hidden_deductable').val(),"family_construct":$('select[name=familyConstruct]').val(),"gci_optional":$('input[name=GCI_optional]:checked').val(),"product_id":$('#plan_name').val()},function(e)
{$("#premiumModalHidden").val(e);e=JSON.parse(e);var premium=0;$("#premiumModalBody").html("");var str='';e.forEach(function(e1){str+="<div style='display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;'><div><span style='color:#da8085;'> Name:  "+"<br/></span><span style='color:#000;'>"+e1.policy_sub_type_id+"</span></div>";str+="<div><span style='color:#da8085;'> Sum Insured </span>"+"<br/><span style='color:#000;'>"+e1.sum_insured+"</span></div>";str+="<div><span style='color:#da8085;'> Premium"+"</span><br/><span style='color:#000;'>"+parseFloat(e1.PremiumServiceTax).toFixed(2)+"</span></div></div>";$("#premiumModalBody").append(str);premium+=parseFloat(e1.PremiumServiceTax);});if(str!=''){get_premium=str;$('#premiumModalBody').html(str);}
$("#premium").val(premium.toFixed(2));if(parseInt(premium)!=0&&!isNaN(premium)){total_premium=premium;$('#premium').val(premium);}});}});function enable_disable_proposal(data){if($('#plan_name').val()){if($('#plan_name').val()=='T03'||$("#plan_name").val()=='T01'){$("#policy_declare_new").show();$("#myGhdMember").hide();if($('#hpi_ghd_td').length){var lead_id_1=$('#hidden_lead_id').val();$.ajax({url:"/tele_get_member_dropdown",type:"POST",data:{lead_id_1:lead_id_1},async:false,success:function(response)
{$('#hpi_ghd_td').html(response);if(proposal_payment_done==0){proposal_create_check();}}});}}else if($('#plan_name').val()=='R06'){if($('#hpi_ghd_td').length){var lead_id_1=$('#hidden_lead_id').val();$.ajax({url:"/tele_get_member_dropdown",type:"POST",data:{lead_id_1:lead_id_1},async:false,success:function(response)
{$('#hpi_ghd_td').html(response);if(proposal_payment_done==0){proposal_create_check();}}});}
$("#policy_declare_new").hide();$("#myGhdMember").show();}
else if($('#plan_name').val()=='T01'){$("#policy_declare_new").show();$("#myGhdMember").hide();}else{$("#policy_declare_new").hide();$("#myGhdMember").show();}
$("#show_hide_proposal").show();if($(data).val()==45||$(data).val()==5){$("#show_hide_proposal").show();}
else if($(data).val()==55||$(data).val()==5&&$("#hidden_is_maker_checker").val()=="yes"){$("#show_hide_proposal").show();}
else{$("#show_hide_proposal").hide();}
if($('#disposition').val()==29){$('#dobdate').removeClass('ignore');$('#preferred_contact_time').removeClass('ignore');}else{$('#dobdate').addClass('ignore');$('#preferred_contact_time').addClass('ignore');}}}
function getRelationHelathpro(){var fam_rel=$('select[name=familyConstruct]').val().split("+");var opt=$(".family_members_id1 option");if($('select[name=familyConstruct]').val()!='1A+1K'||$('select[name=familyConstruct]').val()!='1A+2K'){opt.each(function(e){$(this).css("display","block");});if(fam_rel[0].substr(0,1)=='1')
{opt.each(function(e){if(this.value==0||this.value==1){$(this).removeAttr("disabled").show();}else{$(this).attr('disabled','disabled').hide();}});}
if(fam_rel[0].substr(0,1)>'1')
{opt.each(function(e){if(this.value!=2&&this.value!=3){$(this).removeAttr("disabled").show();}else{$(this).attr('disabled','disabled').hide();}});}
if(fam_rel[1]&&fam_rel[1].substr(0,1)>=1){opt.each(function(e){if(this.value==2||this.value==3){$(this).removeAttr("disabled").show();}});}}}
function getRelation(){var fam_rel=$('select[name=familyConstruct]').val().split("+");var opt=$(".family_members_id1 option");var tempArr=[];if($('select[name=familyConstruct]').val()!='1A+1K'||$('select[name=familyConstruct]').val()!='1A+2K'){opt.each(function(e){$(this).css("display","block");$(this).siblings('[value="'+this.value+'"]').remove();if(this.value!=''){tempArr.push(this.value);}});if(fam_rel[0].substr(0,1)=='1')
{opt.each(function(e){if(this.value==0||this.value==1){$(this).removeAttr("disabled").show();}else{$(this).attr('disabled','disabled').hide();}});}
if(fam_rel[0].substr(0,1)>'1')
{opt.each(function(e){if(this.value!=2&&this.value!=3){$(this).removeAttr("disabled").show();}else{$(this).attr('disabled','disabled').hide();}});}
if(fam_rel[1]&&fam_rel[1].substr(0,1)>=1){opt.each(function(e){if(this.value==2||this.value==3){$(this).removeAttr("disabled").show();}});}}
if($('#plan_name').val()=='T03'||$('#plan_name').val()=='T01'){if(membersCovered.length!==0){var UniqueTempArr=unique(tempArr);opt.each(function(e){if(this.value!=''){if(membersCovered.toString().indexOf(this.value)==-1){$(this).css("display","none");}else{$(this).css("display","block");}
$(this).siblings('[value="'+this.value+'"]').remove();}});}}}
$('input[type=radio][name=GCI_optional]').change(function(){if(($('select[name=sum_insure]').val()!=''||$('select[name=sum_insure]').val()!=undefined)&&$('select[name=sum_insure] :selected').attr("data-policyno")!=''&&$('select[name=familyConstruct]').val()!=''&&$('select[name=plan_name]').val()!=''){$.ajax({url:"tele_apply_changes",type:"POST",data:{'product_id':$('#plan_name').val(),'family_construct':$('select[name=familyConstruct]').val(),'sum_insured':$('select[name=sum_insure]').val(),'gci':$('input[name=GCI_optional]:checked').val(),'only_gci':'Yes'},async:false,dataType:"json",success:function(response){}});$.post("/tele_get_premium",{"sum_insured":$('select[name=sum_insure]').val(),"policy_detail_id":$('select[name=sum_insure] :selected').attr("data-policyno"),"deductable":$('#hidden_deductable').val(),"family_construct":$('select[name=familyConstruct]').val(),"gci_optional":$('input[name=GCI_optional]:checked').val(),"product_id":$('#plan_name').val()},function(e)
{$("#premiumModalHidden").val(e);e=JSON.parse(e);var premium=0;$("#premiumModalBody").html("");var str='';e.forEach(function(e1){str+="<div style='display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;'><div><span style='color:#da8085;'> Name:  "+"<br/></span><span style='color:#000;'>"+e1.policy_sub_type_id+"</span></div>";str+="<div><span style='color:#da8085;'> Sum Insured </span>"+"<br/><span style='color:#000;'>"+e1.sum_insured+"</span></div>";str+="<div><span style='color:#da8085;'> Premium"+"</span><br/><span style='color:#000;'>"+parseFloat(e1.PremiumServiceTax).toFixed(2)+"</span></div></div>";$("#premiumModalBody").append(str);premium+=parseFloat(e1.PremiumServiceTax);});if(str!=''){get_premium=str;$('#premiumModalBody').html(str);}
$("#premium").val(premium.toFixed(2));if(parseInt(premium)!=0&&!isNaN(premium)){total_premium=premium;$('#premium').val(premium);}});}})
function getPremiumNew(){if($("#plan_name").val()!="T03"){var policy_detail_id=$('select[name=sum_insure] :selected').attr("data-policyno");}else{var policy_detail_id=$("input[name='policy_selection']:checked").val()}
$.post("/tele_get_premium",{"sum_insured":$('select[name=sum_insure]').val(),"policy_detail_id":policy_detail_id,"deductable":$('#hidden_deductable').val(),"family_construct":$('select[name=familyConstruct]').val(),"gci_optional":$('input[name=GCI_optional]:checked').val(),"product_id":$('#plan_name').val()},function(e)
{$("#premiumModalHidden").val(e);e=JSON.parse(e);var premium=0;$("#premiumModalBody").html("");var str='';e.forEach(function(e1){str+="<div style='display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;'><div><span style='color:#da8085;'> Name:  "+"<br/></span><span style='color:#000;'>"+e1.policy_sub_type_id+"</span></div>";str+="<div><span style='color:#da8085;'> Sum Insured </span>"+"<br/><span style='color:#000;'>"+e1.sum_insured+"</span></div>";str+="<div><span style='color:#da8085;'> Premium"+"</span><br/><span style='color:#000;'>"+parseFloat(e1.PremiumServiceTax).toFixed(2)+"</span></div></div>";$("#premiumModalBody").append(str);premium+=parseFloat(e1.PremiumServiceTax);});if(str!=''){get_premium=str;$('#premiumModalBody').html(str);}
$("#premium").val(premium.toFixed(2));if(parseInt(premium)!=0&&!isNaN(premium)){total_premium=premium;$('#premium').val(premium);}else{$('#premium').val("0");}});}
function getPremium(selectChange)
{$.post("/tele_get_premium",{"sum_insured":selectChange.find('select[name=sum_insure]').val(),"policy_detail_id":selectChange.find('select[name=sum_insure] :selected').attr("data-policyno"),"deductable":$('#hidden_deductable').val(),"family_construct":selectChange.find('select[name=familyConstruct]').val(),"gci_optional":$('input[name=GCI_optional]:checked').val(),"product_id":$('#plan_name').val()},function(e)
{$("#premiumModalHidden").val(e);e=JSON.parse(e);var premium=0;$("#premiumModalBody").html("");e.forEach(function(e1){str="<div style='display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;'><div><span style='color:#da8085;'> Name:  "+"<br/></span><span style='color:#000;'>"+e1.policy_sub_type_id+"</span></div>";str+="<div><span style='color:#da8085;'> Sum Insured </span>"+"<br/><span style='color:#000;'>"+e1.sum_insured+"</span></div>";str+="<div><span style='color:#da8085;'> Premium"+"</span><br/><span style='color:#000;'>"+parseFloat(e1.PremiumServiceTax).toFixed(2)+"</span></div></div>";$("#premiumModalBody").append(str);premium+=parseFloat(e1.PremiumServiceTax);});$("#premium").val(premium.toFixed(2));});}
function getPremiumByAge(id){var familyConstruct=$("#"+id).val();$("#family_const_id").val(id);$("#getMaxPremiumAgeLabel").html('');if(familyConstruct=='1A')
{$("#getMaxPremiumAgeLabel").html('Enter Member Age');}
else
{$("#getMaxPremiumAgeLabel").html('Enter Eldest Member Age');}
$("#getMaxPremiumAgeModal").modal();}
function changes(e)
{selectChange=$(e).closest(".row");set_non_editable(selectChange,1);if($('#plan_name').val()=='T03'||$('#plan_name').val()=='T01'){var valueArray=$('.family_members_id1').map(function(){if(this.value!=0&&this.value!=1){return this.value;}}).get();$.ajax
({url:"/tele_family_details_healthproxl",type:"POST",data:{relation_id:$(e).val(),selectedRelation:valueArray},dataType:"json",beforeSend:function(){set_session();},success:function(response)
{var dataOpt=selectChange.find("[name='family_members_id[]'] :selected").attr("data-opt");selectChange.find("input[name='first_name[]']").val("");selectChange.find("input[name='middle_name[]']").val("");selectChange.find("input[name='last_name[]']").val("");selectChange.find("input[name='family_id']").val("");selectChange.find("input[type='text'][name='family_date_birth[]']").val("");selectChange.find("input[name='age[]']").val("");selectChange.find("input[name='age_type[]']").val("");selectChange.find("input[name='family_gender[]']").val("");selectChange.find("[name='family_salutation[]']").val("");selectChange.find("input[name='mem_email_id[]']").val("");selectChange.find("input[name='mem_mob_no[]']").val("");var set_blank_variable=selectChange.find("[name='family_members_id[]'] :selected").val();set_blank(set_blank_variable);var family_detail=response.family_data;var i;if(true)
{if(family_detail.length!=0)
{for(i=0;i<family_detail.length;i++)
{if(family_detail[i].fr_id=="0")
{set_blank(set_blank_variable);selectChange.find("input[name='first_name[]']").val(family_detail[i].emp_firstname.toUpperCase());selectChange.find("input[name='last_name[]']").val(family_detail[i].emp_lastname.toUpperCase());selectChange.find("input[name='middle_name[]']").val(family_detail[i].emp_middlename);selectChange.find("input[name='family_id']").val(family_detail[i].family_id);selectChange.find("input[name='family_gender[]']").val(family_detail[i].gender);selectChange.find("select[name='family_salutation[]']").val(family_detail[i].salutation);selectChange.find("input[type='text'][name='family_date_birth[]']").val(family_detail[i].bdate);selectChange.find("input[name='mem_email_id[]']").val(family_detail[i].email);selectChange.find("input[name='mem_mob_no[]']").val(family_detail[i].mob_no);get_age(family_detail[i].bdate,selectChange);set_blank(set_blank_variable);set_non_editable(selectChange,0);if($('#plan_name').val()=='T03'){selectChange.find("input[name='mem_email_id[]']").parent().show();selectChange.find("input[name='mem_email_id[]']").attr('required',true);selectChange.find("input[name='mem_mob_no[]']").attr('required',true);selectChange.find("input[name='mem_mob_no[]']").parent().show();}}
else
{var gen=selectChange.find("[name='family_members_id[]'] :selected").html();if(gen=='Spouse')
{set_non_editable(selectChange,1);if($("#gender1").val()=='Male')
{selectChange.find('[name="family_gender[]"]').val("Female");selectChange.find("select[name='family_salutation[]']").val("Mrs");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else if($("#gender1").val()=='Female')
{selectChange.find('[name="family_gender[]"]').val("Male");selectChange.find("select[name='family_salutation[]']").val("Mr");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else
{selectChange.find('[name="family_gender[]"]').val(" ");selectChange.find("[name='family_salutation[]']").val("");selectChange.find("select[name='family_salutation[]']").prop('disabled',false);}
if(family_detail[i].policy_member_first_name){selectChange.find("input[name='first_name[]']").val(family_detail[i].policy_member_first_name.toUpperCase());}
if(family_detail[i].policy_member_middle_name){selectChange.find("input[name='middle_name[]']").val(family_detail[i].policy_member_middle_name.toUpperCase());}
if(family_detail[i].policy_member_last_name){selectChange.find("input[name='last_name[]']").val(family_detail[i].policy_member_last_name.toUpperCase());}
if(family_detail[i].policy_member_email_id){selectChange.find("input[name='mem_email_id[]']").val(family_detail[i].policy_member_email_id);}
if(family_detail[i].policy_member_mob_no){selectChange.find("input[name='mem_mob_no[]']").val(family_detail[i].policy_member_mob_no);}
selectChange.find("#family_id").val(family_detail[i].policy_member_last_name);selectChange.find("input[type='text'][name='family_date_birth[]']").val(family_detail[i].policy_mem_dob);selectChange.find("input[name='marriage_date']").val(family_detail[i].marriage_date);selectChange.find("input[type='text'][name='age[]']").val(family_detail[i].age);selectChange.find("input[type='text'][name='age_type[]']").val(family_detail[i].age_type);get_age(family_detail[i].policy_mem_dob,selectChange);if($('#plan_name').val()=='T03'){selectChange.find("input[name='mem_email_id[]']").parent().show();selectChange.find("input[name='mem_email_id[]']").attr('required',true);selectChange.find("input[name='mem_mob_no[]']").attr('required',true);selectChange.find("input[name='mem_mob_no[]']").parent().show();}}
else
{if(gen!='Spouse'||gen!='Self')
{selectChange.find("select[name='family_salutation[]']").prop('disabled',false);selectChange.find('[name="family_gender[]"]').val(dataOpt);if(selectChange.find('[name="family_gender[]"]').val()=='Male')
{salutation_hide_show(selectChange,'Male');}
else if(selectChange.find('[name="family_gender[]"]').val()=='Female')
{salutation_hide_show(selectChange,'Female');}
var gen_id=selectChange.find("[name='family_members_id[]'] :selected").val();if(gen_id=='2'||gen_id=='3')
{if(selectChange.find('[name="family_gender[]"]').val()=='Male')
{selectChange.find("select[name='family_salutation[]']").val("Master");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else if(selectChange.find('[name="family_gender[]"]').val()=='Female')
{selectChange.find("select[name='family_salutation[]']").val("Ms");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}}
selectChange.find("input[type='text'][name='family_date_birth[]']").val(family_detail[i].policy_mem_dob);get_age(family_detail[i].policy_mem_dob,selectChange);selectChange.find("input[name='mem_email_id[]']").parent().hide();selectChange.find("input[name='mem_email_id[]']").attr('required',false);selectChange.find("input[name='mem_mob_no[]']").attr('required',false);selectChange.find("input[name='mem_mob_no[]']").parent().hide();}}}}}
else
{var gen=selectChange.find("[name='family_members_id[]'] :selected").html();var gen_id=selectChange.find("[name='family_members_id[]'] :selected").val();if(gen=='Spouse')
{set_non_editable(selectChange,1);if($("#gender1").val()=='Male')
{selectChange.find('[name="family_gender[]"]').val("Female");selectChange.find("select[name='family_salutation[]']").val("Mrs");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else if($("#gender1").val()=='Female')
{selectChange.find('[name="family_gender[]"]').val("Male");selectChange.find("select[name='family_salutation[]']").val("Mr");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else
{selectChange.find('[name="family_gender[]"]').val(" ");selectChange.find("[name='family_salutation[]']").val("");selectChange.find("select[name='family_salutation[]']").prop('disabled',false);}}
else
{if(gen!='Spouse'||gen!='Self')
{set_non_editable(selectChange,1);selectChange.find("select[name='family_salutation[]']").prop('disabled',false);selectChange.find('[name="family_gender[]"]').val(dataOpt);if(gen_id=='2'||gen_id=='3')
{if(selectChange.find('[name="family_gender[]"]').val()=='Male')
{selectChange.find("select[name='family_salutation[]']").val("Master");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else if(selectChange.find('[name="family_gender[]"]').val()=='Female')
{selectChange.find("select[name='family_salutation[]']").val("Ms");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}}
else
{if(selectChange.find('[name="family_gender[]"]').val()=='Male')
{selectChange.find('.female_gen').prop('disabled',true);selectChange.find('.female_gen').hide();selectChange.find('.male_gen').prop('disabled',false);selectChange.find('.male_gen').show();}
else if(selectChange.find('[name="family_gender[]"]').val()=='Female')
{selectChange.find('.female_gen').prop('disabled',false);selectChange.find('.female_gen').show();selectChange.find('.male_gen').prop('disabled',true);selectChange.find('.male_gen').hide();}}
selectChange.find("input[type='text'][name='family_date_birth[]']").val(family_detail[i].policy_mem_dob);}}}}}});}else{$.ajax
({url:"/tele_family_details",type:"POST",data:{relation_id:$(e).val()},dataType:"json",beforeSend:function(){set_session();},success:function(response)
{var dataOpt=selectChange.find("[name='family_members_id[]'] :selected").attr("data-opt");selectChange.find("input[name='first_name[]']").val("");selectChange.find("input[name='middle_name[]']").val("");selectChange.find("input[name='last_name[]']").val("");selectChange.find("input[name='family_id']").val("");selectChange.find("input[type='text'][name='family_date_birth[]']").val("");selectChange.find("input[name='age[]']").val("");selectChange.find("input[name='age_type[]']").val("");selectChange.find("input[name='family_gender[]']").val("");selectChange.find("[name='family_salutation[]']").val("");var set_blank_variable=selectChange.find("[name='family_members_id[]'] :selected").val();set_blank(set_blank_variable);var family_detail=response.family_data;var i;if(true)
{if(family_detail.length!=0)
{for(i=0;i<family_detail.length;i++)
{if(family_detail[i].fr_id=="0")
{set_blank(set_blank_variable);selectChange.find("input[name='first_name[]']").val(family_detail[i].emp_firstname.toUpperCase());selectChange.find("input[name='last_name[]']").val(family_detail[i].emp_lastname.toUpperCase());selectChange.find("input[name='middle_name[]']").val(family_detail[i].emp_middlename);selectChange.find("input[name='family_id']").val(family_detail[i].family_id);selectChange.find("input[name='family_gender[]']").val(family_detail[i].gender);selectChange.find("select[name='family_salutation[]']").val(family_detail[i].salutation);selectChange.find("input[type='text'][name='family_date_birth[]']").val(family_detail[i].bdate);get_age(family_detail[i].bdate,selectChange);set_blank(set_blank_variable);set_non_editable(selectChange,0);}
else
{var gen=selectChange.find("[name='family_members_id[]'] :selected").html();if(gen=='Spouse')
{set_non_editable(selectChange,1);if($("#gender1").val()=='Male')
{selectChange.find('[name="family_gender[]"]').val("Female");selectChange.find("select[name='family_salutation[]']").val("Mrs");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else if($("#gender1").val()=='Female')
{selectChange.find('[name="family_gender[]"]').val("Male");selectChange.find("select[name='family_salutation[]']").val("Mr");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else
{selectChange.find('[name="family_gender[]"]').val(" ");selectChange.find("[name='family_salutation[]']").val("");selectChange.find("select[name='family_salutation[]']").prop('disabled',false);}
if(family_detail[i].policy_member_first_name){selectChange.find("input[name='first_name[]']").val(family_detail[i].policy_member_first_name.toUpperCase());}
if(family_detail[i].policy_member_middle_name){selectChange.find("input[name='middle_name[]']").val(family_detail[i].policy_member_middle_name.toUpperCase());}
if(family_detail[i].policy_member_last_name){selectChange.find("input[name='last_name[]']").val(family_detail[i].policy_member_last_name.toUpperCase());}
selectChange.find("#family_id").val(family_detail[i].policy_member_last_name);selectChange.find("input[type='text'][name='family_date_birth[]']").val(family_detail[i].policy_mem_dob);selectChange.find("input[name='marriage_date']").val(family_detail[i].marriage_date);selectChange.find("input[type='text'][name='age[]']").val(family_detail[i].age);selectChange.find("input[type='text'][name='age_type[]']").val(family_detail[i].age_type);get_age(family_detail[i].bdate,selectChange);}
else
{if(gen!='Spouse'||gen!='Self')
{selectChange.find("select[name='family_salutation[]']").prop('disabled',false);selectChange.find('[name="family_gender[]"]').val(dataOpt);if(selectChange.find('[name="family_gender[]"]').val()=='Male')
{salutation_hide_show(selectChange,'Male');}
else if(selectChange.find('[name="family_gender[]"]').val()=='Female')
{salutation_hide_show(selectChange,'Female');}}}}}}
else
{var gen=selectChange.find("[name='family_members_id[]'] :selected").html();var gen_id=selectChange.find("[name='family_members_id[]'] :selected").val();if(gen=='Spouse')
{set_non_editable(selectChange,1);if($("#gender1").val()=='Male')
{selectChange.find('[name="family_gender[]"]').val("Female");selectChange.find("select[name='family_salutation[]']").val("Mrs");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else if($("#gender1").val()=='Female')
{selectChange.find('[name="family_gender[]"]').val("Male");selectChange.find("select[name='family_salutation[]']").val("Mr");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else
{selectChange.find('[name="family_gender[]"]').val(" ");selectChange.find("[name='family_salutation[]']").val("");selectChange.find("select[name='family_salutation[]']").prop('disabled',false);}}
else
{if(gen!='Spouse'||gen!='Self')
{set_non_editable(selectChange,1);selectChange.find("select[name='family_salutation[]']").prop('disabled',false);selectChange.find('[name="family_gender[]"]').val(dataOpt);if(gen_id=='2'||gen_id=='3')
{if(selectChange.find('[name="family_gender[]"]').val()=='Male')
{selectChange.find("select[name='family_salutation[]']").val("Master");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}
else if(selectChange.find('[name="family_gender[]"]').val()=='Female')
{selectChange.find("select[name='family_salutation[]']").val("Ms");selectChange.find("select[name='family_salutation[]']").prop('disabled',true);}}
else
{if(selectChange.find('[name="family_gender[]"]').val()=='Male')
{selectChange.find('.female_gen').prop('disabled',true);selectChange.find('.female_gen').hide();selectChange.find('.male_gen').prop('disabled',false);selectChange.find('.male_gen').show();}
else if(selectChange.find('[name="family_gender[]"]').val()=='Female')
{selectChange.find('.female_gen').prop('disabled',false);selectChange.find('.female_gen').show();selectChange.find('.male_gen').prop('disabled',true);selectChange.find('.male_gen').hide();}}}}}}}});}}
function set_blank(set_blank_variable)
{if(set_blank_variable=='')
{set_non_editable(selectChange,1);selectChange.find("input[name='first_name[]']").val("");selectChange.find("input[name='middle_name[]']").val("");selectChange.find("input[name='last_name[]']").val("");selectChange.find("input[name='family_id']").val("");selectChange.find("input[type='text'][name='family_date_birth[]']").val("");selectChange.find("input[name='age[]']").val("");selectChange.find("[name='family_salutation[]']").val("");selectChange.find("input[name='age_type[]']").val("");selectChange.find("input[name='family_gender[]']").val("");}}
function set_non_editable(selectChange,Is_edit)
{if(Is_edit==0)
{selectChange.find("input[name='first_name[]']").attr('disabled','disabled');selectChange.find("input[name='last_name[]']").attr('disabled','disabled');selectChange.find("input[name='middle_name[]']").attr('disabled','disabled');selectChange.find("input[name='family_id']").attr('disabled','disabled');selectChange.find("input[name='family_gender[]']").attr('disabled','disabled');selectChange.find("select[name='family_salutation[]']").attr('disabled','disabled');selectChange.find("input[name='mem_email_id[]']").attr('disabled','disabled');selectChange.find("input[name='mem_mob_no[]']").attr('disabled','disabled');}
else
{selectChange.find("input[name='first_name[]']").removeAttr('disabled','disabled');selectChange.find("input[name='last_name[]']").removeAttr('disabled','disabled');selectChange.find("input[name='middle_name[]']").removeAttr('disabled','disabled');selectChange.find("input[name='family_id']").removeAttr('disabled','disabled');selectChange.find("input[name='family_gender[]']").removeAttr('disabled','disabled');selectChange.find("select[name='family_salutation[]']").removeAttr('disabled','disabled');selectChange.find("input[name='mem_email_id[]']").removeAttr('disabled','disabled');selectChange.find("input[name='mem_mob_no[]']").removeAttr('disabled','disabled');}}
$(".dobdate").datepicker({dateFormat:"dd-mm-yy",prevText:'<i class="fa fa-angle-left"></i>',nextText:'<i class="fa fa-angle-right"></i>',changeMonth:true,changeYear:true,minDate:0,yearRange:"-60: +30",onSelect:function(dateText,inst)
{$(this).val(dateText);}});function convertDate(inputFormat)
{var b=inputFormat.split(/\D/);return b.reverse().join('-');}
function get_age(dateStrings,selectChange='')
{var dateString=convertDate(dateStrings);var age_type;var today=new Date();var birthDate=new Date(dateString);var age=today.getFullYear()-birthDate.getFullYear();var m=today.getMonth()-birthDate.getMonth();if(m<0||(m===0&&today.getDate()<birthDate.getDate())){age--;}
if(age!=0)
{age_type=" years";}else
{var oneDay=24*60*60*1000;var firstDate=new Date();var secondDate=new Date(dateString);var diffDays=Math.round(Math.abs((firstDate-secondDate)/oneDay));age=diffDays;age_type="days";}
selectChange.find("input[name='age[]']").val(age);selectChange.find("input[name='age_type[]']").val(age_type);}
function get_age_family(e,selectChange)
{var today=new Date();var dob=new Date(e);var z=e.split("-");var dob=new Date(z[2],z[1]-1,z[0]);var today_mon=today.getMonth();var dob_mon=dob.getMonth();var dob_day=dob.getDate();var today_day=today.getDate();var age_distance=today.getFullYear()-dob.getFullYear();if(today_mon>=dob_mon&&today_day>=dob_day)
{if(age_distance>0)
{selectChange.find("input[name='age[]']").val(age_distance);selectChange.find("input[name='age_type[]']").val("years");}
else
{var month=("0"+(today.getMonth()+1)).substr(-2);var strDate=("0"+today.getDate()).substr("-2")+"-"+("0"+month).substr("-2")+"-"+today.getFullYear();var strDate=today.getDate()+"-"+month+"-"+today.getFullYear();var date=strDate.split("-");var display_date=date[2]+"-"+date[1]+"-"+date[0];var date=e.split("-");var date_bday=date[2]+"-"+date[1]+"-"+date[0];var day=new Date(display_date).getTime()-new Date(date_bday).getTime();var days=Math.floor(day/(1000*60*60*24));selectChange.find("input[name='age[]']").val(days);selectChange.find("input[name='age_type[]']").val("days");}}
else
{if(age_distance>1)
{selectChange.find("input[name='age[]']").val(age_distance);selectChange.find("input[name='age_type[]']").val("years");var age_distances=age_distance-1;}
else if(age_distance==1)
{var month=("0"+(today.getMonth()+1)).substr(-2);var strDate=("0"+today.getDate()).substr(-2)+"-"+("0"+month).substr(-2)+"-"+today.getFullYear();var date=strDate.split("-");var display_date=date[2]+"-"+date[1]+"-"+date[0];var date=e.split("-");var date_bday=date[2]+"-"+date[1]+"-"+date[0];var day=new Date(display_date).getTime()-new Date(date_bday).getTime();var days=Math.floor(day/(1000*60*60*24));if(days>=365)
{selectChange.find("input[name='age[]']").val(1);selectChange.find("input[name='age_type[]']").val("years");}
else
{selectChange.find("input[name='age[]']").val(days);selectChange.find("input[name='age_type[]']").val("days");}}
else
{var month=("0"+(today.getMonth()+1)).substr(-2);var strDate=("0"+today.getDate()).substr("-2")+"-"+("0"+month).substr("-2")+"-"+today.getFullYear();var strDate=today.getDate()+"-"+month+"-"+today.getFullYear();var date=strDate.split("-");var display_date=date[2]+"-"+date[1]+"-"+date[0];var date=e.split("-");var date_bday=date[2]+"-"+date[1]+"-"+date[0];var day=new Date(display_date).getTime()-new Date(date_bday).getTime();var days=Math.floor(day/(1000*60*60*24));selectChange.find("input[name='age[]']").val(days);selectChange.find("input[name='age_type[]']").val("days");}}}
$(document).on("change","input:checkbox[name='sub_type_check[]']",function()
{var sub_type_id=$(this).val();var id=$(this).attr('id');var lastChar=id.slice(-1);$("#di"+sub_type_id+lastChar).html('');$("#di"+sub_type_id+lastChar).remove();if($(this).is(":checked")&&sub_type_id!='')
{get_sub_data(sub_type_id,lastChar);}
else
{$("#di"+sub_type_id+lastChar).html('');$("#di"+sub_type_id+lastChar).remove();}});function get_sub_data(sub_type_id,lastChar='')
{$('#di'+sub_type_id+lastChar).empty();$.ajax({url:"/tele_member_declaration_question",type:"POST",dataType:"html",async:false,data:{'sub_type_id':sub_type_id,'member_id':lastChar},success:function(response)
{if($('#di'+sub_type_id+lastChar).length==0)
{$(".quest_declare_benifit_4s"+lastChar).append('<div id =di'+sub_type_id+lastChar+'>'+response+'</div>');}
else
{$("#di"+sub_type_id+lastChar).remove();}}});}
$("#patForm").validate({ignore:".ignore",focusInvalid:true,rules:{sum_insure:{required:true},anuual_income:{required:true,},occupation:{required:true},familyConstruct:{required:true},premium:{required:true},'businessType':{required:true},'family_members_id[]':{required:true},'family_gender[]':{required:true},'first_name[]':{required:true},'family_date_birth[]':{required:true},'age[]':{required:true},'age_type[]':{required:true},},messages:{valid_annual_income:'SI '},submitHandler:function(form){set_session();if(!Number($("#premium").val())){swal("Alert","Invalid Premium","warning");return;}
if($("#premium").val()=='undefined')
{swal("Alert","Invalid Premium","warning");return;}
var family_construct=$('#patFamilyConstruct option:selected').val();var result=family_construct.split('+');var add_length=[];add_length.push(parseInt(result[0]));add_length.push(parseInt(result[1]));var i;var TableData2=[];var TableData3=[];var TableData5=[];var TableData6=[];for(i=0;i<sum(add_length);i++){var TableData=[];var TableData4=[];$(".disease"+i).find('input:checkbox').each(function(){if($(this).is(":checked")){TableData4.push($(this).val());}});TableData3[i]=TableData4;if(TableData4.length>0){TableData6.push(1);}
$(".disease"+i).find('#mydatasmember tr').each(function(row,tr)
{var content=$(tr).find('.mycontent').val();if($(tr).find('input[name="'+content+'"]:checked').val()=='Yes'){TableData5.push(1);}
TableData[row]={"question":content,"format":$(tr).find('input[name="'+content+'"]:checked').val(),}});TableData2[i]=TableData;}
if(TableData6.length>1){swal({title:"Alert",text:"Only one member is allow with Chronic Disease",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function()
{});return;}
if(TableData5.length>0){swal({title:"Alert",text:"Cannot proceed with Chronic Disease Yes",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function()
{});return;}
$('[name="family_date_birth[]"]').each(function(){$(this).prop("disabled",false);});selectChange=$('#patForm').closest("form");set_non_editable(selectChange,1);var policyNo=$("#sum_insures :selected").attr("data-policyno");var plan_name=$('#plan_name').val();var premium_pat=$('#patFamilyConstruct option:selected').data('premium');if(premium_pat==''||premium_pat==undefined){var premium_pat=$("#premium").val();}
selectChange.find("select[name='family_salutation[]']").removeAttr('disabled','disabled');var familyDataType=$("#sum_insures :selected").attr("data-type");$(".family_members_id1").prop('disabled',false);var family_members_id=$(".family_members_id1").val();if($("#plan_name").val()=='T03'){var finalPremium=$("#premium").val();}else{var finalPremium=premium_pat;}
var form=$("#patForm").serialize()+"&plan_name="+$('#plan_name').val()+"&GCI_optional="+$("input[name='GCI_optional']:checked").val()+"&premium="+finalPremium+"&policyNo="+$("#sum_insures :selected").attr("data-policyno")+"&familyDataType="+familyDataType+"&declare="+JSON.stringify(TableData2)+"&chronic="+JSON.stringify(TableData3);var master_policy=$("#master_policy_number").val();var GCI_optional=$("input[name='GCI_optional']:checked").val();var agent_details=$("#hidden_agent_section").val();var customer_details=$("#hidden_customer_section").val();if(agent_details==0||customer_details==0){swal({title:"Alert",text:"Please SAVE the values entered so far to proceed with new Section!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});return false;}
form=form+"&empId="+$('#empidaxistele').val()+"&hidden_policy_id="+$('#hidden_policy_id').val()+"&hidden_deductable="+$('#hidden_deductable').val()+"&sum_insure="+$("#sum_insures").val()+"&familyConstruct="+$("#patFamilyConstruct").val();if(($("#plan_name").val()=='T03'&&$('#hidden_policy_id').val()==TELE_HEALTHPROINFINITY_GHI_GPA&&is_self_purchased==1)||(is_self_purchased==1&&$("#plan_name").val()=='T01')){if(parseInt(self_purcased_with_si)<parseInt($('#sum_insures').val())){swal("Alert",'SI should be less or equal to '+self_purcased_with_si+' !',"warning");return false;}}
ajaxindicatorstart("Please wait ... ");$.post("/tele_family_details_insert",form,function(e)
{$('[name="family_date_birth[]"]').each(function(){});ajaxindicatorstop();var data=JSON.parse(e);if(!data.status)
{if(data.check=="declaration")
{$('#confr').hide();}
swal({title:"Alert",text:data.message,type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function()
{});return;}
if(family_members_id==0)
{set_non_editable(selectChange,0)}
swal("Alert",data.message,"success");$("#B_data").show();$("#C_data").hide();$("#D_data").hide();$("#E_data").hide();$("#B_remark").hide();$(".B").hide();$('#chronic th input[type="checkbox"]').prop('checked',false);$(".tt").empty();$("#patFormSubmit").closest("form").find("select[name='family_members_id[]']").css("pointer-events",'auto');$('#confr').show();$("#patForm").find("input[name='edit']").val("0");$("#premium").attr('disabled','disabled');$("#plan_name").attr('disabled','disabled');if($('#plan_name').val()=='T03'){$("#sum_insures").attr('disabled','disabled');$("#patFamilyConstruct").attr('disabled','disabled');}
var sum_insures=$("#sum_insures").val();var patFamilyConstruct=$("#patFamilyConstruct").val();var premium=$("#premium").val();document.getElementById("patForm").reset();$("#master_policy_number").val(master_policy);$("#sum_insures").val(sum_insures);$("#patFamilyConstruct").val(patFamilyConstruct);$("#premium").val(premium);$("#plan_name").val(plan_name);if(GCI_optional=='No'){$('#GCI_no').prop('checked',true);}else{$('#GCI_yes').prop('checked',true);}
$("#hidden_policy_section").val(1);addDependentForm("patTable",JSON.parse(e));proposal_create_check();});if($("#plan_name").val()=="T01"||$("#plan_name").val()=="T03"){getPremiumNew();}}});function get_blank_validation()
{var abc=$('input[type=radio][name="myGHD[B][format]"]:checked').val();var user=$('input[name^="myGHD"]');var count=0;var k=0;var data=$('input[name$="[format]"]');var obj=data.length;for(var i=0;i<obj;i++)
{var str=data[i].name;var str_id=data[i].id;var split_format=str_id.split("_");var get_tr=split_format[0].replace(/\d+/g,'')+"_data";if($("#"+get_tr).css('display')!='none')
{if($('input[name$="'+str+'"]').is(":checked"))
{}
else
{return false;}}}}
function get_remark_validation()
{var user=$('input[name^="myGHD"]');var count=0;var k=0;var data=$('input[name$="[remark]"]');var obj=data.length;for(var i=0;i<obj;i++)
{var str=data[i].name;var dat=str.replace("[remark]","[format]");if($('input[name$="'+dat+'"]').is(":checked"))
{var split_formats=$('input[name$="'+dat+'"]:checked').val();var split_format=$('input[name$="'+dat+'"]:checked').val().split("_");var join_split="#"+split_format[0];var test_class=split_format[0];var remark=$(join_split+"_remark").val();if(split_format[1]=='Yes')
{$('.'+test_class).show();if(remark=="")
{if($('.'+test_class).length==0)
{$(join_split+"_remark").after("<span style='color:red;' class='"+test_class+"'>Remark  is required</span>");}
count=1;}}
if(split_format[1]=='No')
{$('.'+test_class).hide();k++;}}
else
{}}
if(count==1)
{return false;}
if(k>=6)
{return true;}}
$("#premiumBif").on("click",function(){if($("#premiumModalBody").html().trim()){}
$("#premiumModal").modal();});function get_fam_data(elem)
{var gen=$("#nominee_relation").val();if(gen==1)
{if($("#gender1").val()=='Male')
{$("#nominee_gender").val("Female");$(".nominee_female_gen").css('display','block');$(".nominee_male_gen").css('display','none');$("#nominee_salutation").val("Mrs");}
else if($("#gender1").val()=='Female')
{$("#nominee_gender").val("Male");$("#nominee_salutation").val("Mr");$(".nominee_female_gen").css('display','none');$(".nominee_male_gen").css('display','block');}}
else
{var dataOpt=$("select[name='nominee_relation'] :selected").attr("data-opt");if(dataOpt=='Male')
{$(".nominee_female_gen").css('display','none');$("#nominee_salutation").val("Mr");$(".nominee_male_gen").css('display','block');}else if(dataOpt=='Female'){$("#nominee_salutation").val("Ms");$(".nominee_female_gen").css('display','block');$(".nominee_male_gen").css('display','none');}
$("#nominee_gender").val(dataOpt);}
$.ajax({url:"/tele_family_details",type:"POST",data:{relation_id:elem.value,},async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response)
{$("#nominee_fname").val("");$("#nominee_lname").val("");$("input[type='text'][name='nominee_dob']").val("");$('#nominee_contact').val("");var family_detail=response.family_data;if(family_detail.length!=0)
{if(family_detail[0].fr_id=="2"||family_detail[0].fr_id=="3")
{$("#body_modal").html("");for($i=0;$i<family_detail.length;$i++)
{$("#body_modal").append('<input type="radio" name ="radio_option" value= '+family_detail[$i]["policy_member_id"]+"> "+family_detail[$i].policy_member_first_name+"<br>");}
$("#myModal").modal();}
else if(family_detail[0].fr_id=="0")
{$("#nominee_fname").val(family_detail[0].policy_member_first_name.toUpperCase());$("#nominee_lname").val(family_detail[0].policy_member_last_name.toUpperCase());$("#nominee_gender").val(family_detail[0].policy_mem_gender);$("#nominee_email").val(family_detail[0].policy_member_email_id);$("#nominee_contact").val(family_detail[0].policy_member_mob_no);$("#dob").val(family_detail[0].policy_mem_dob);}else
{$('#nominee_salutation').attr('disabled',true);if(family_detail[0].policy_member_first_name.toUpperCase()){$("#nominee_fname").val(family_detail[0].policy_member_first_name.toUpperCase());$("#nominee_fname").attr('readonly',true);}
if(family_detail[0].policy_member_last_name.toUpperCase()){$("#nominee_lname").val(family_detail[0].policy_member_last_name.toUpperCase());$('#nominee_lname').attr('readonly',true);}
if(family_detail[0].policy_mem_gender){$("#nominee_gender").val(family_detail[0].policy_mem_gender);$('#nominee_gender').attr('readonly',true);}
if(family_detail[0].policy_mem_dob){$("input[type='text'][name='nominee_dob']").val(family_detail[0].policy_mem_dob);$('#nomineedob').attr('disabled',true);}
if(family_detail[0].policy_member_mob_no){$("input[type='text'][name='nominee_contact']").val(family_detail[0].policy_member_mob_no);$('#nominee_contact').attr('disabled',true);}
if(family_detail[0].policy_member_email_id){$("input[type='text'][name='nominee_email']").val(family_detail[0].policy_member_email_id);$('#nominee_email').attr('disabled',true);}}}}});}
function get_fam_data2(elem)
{var gen=$("#nominee_relation").val();if(gen==1)
{if($("#gender1").val()=='Male')
{$("#nominee_gender").val("Female");$(".nominee_female_gen").css('display','block');$(".nominee_male_gen").css('display','none');$("#nominee_salutation").val("Mrs");}
else if($("#gender1").val()=='Female')
{$("#nominee_gender").val("Male");$("#nominee_salutation").val("Mr");$(".nominee_female_gen").css('display','none');$(".nominee_male_gen").css('display','block');}}
else
{var dataOpt=$("select[name='nominee_relation'] :selected").attr("data-opt");if(dataOpt=='Male')
{$(".nominee_female_gen").css('display','none');$("#nominee_salutation").val("Mr");$(".nominee_male_gen").css('display','block');}else if(dataOpt=='Female'){$("#nominee_salutation").val("");$(".nominee_female_gen").css('display','block');$(".nominee_male_gen").css('display','none');}
$("#nominee_gender").val(dataOpt);}
$.ajax({url:"/tele_family_details",type:"POST",data:{relation_id:elem.value,},async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response)
{$("#nominee_fname").val("");$("#nominee_lname").val("");$("input[type='text'][name='nominee_dob']").val("");$('#nominee_contact').val("");var family_detail=response.family_data;if(family_detail.length!=0)
{if(family_detail[0].fr_id=="2"||family_detail[0].fr_id=="3")
{$("#body_modal").html("");for($i=0;$i<family_detail.length;$i++)
{$("#body_modal").append('<input type="radio" name ="radio_option" value= '+family_detail[$i]["policy_member_id"]+"> "+family_detail[$i].policy_member_first_name+"<br>");}
$("#myModal").modal();}
else if(family_detail[0].fr_id=="0")
{$("#nominee_fname").val(family_detail[0].policy_member_first_name.toUpperCase());$("#nominee_lname").val(family_detail[0].policy_member_last_name.toUpperCase());$("#nominee_gender").val(family_detail[0].policy_mem_gender);$("#dob").val(family_detail[0].policy_mem_dob);}else
{$("#nominee_fname").val(family_detail[0].policy_member_first_name.toUpperCase());$("#nominee_lname").val(family_detail[0].policy_member_last_name.toUpperCase());$("#nominee_gender").val(family_detail[0].policy_mem_gender);$("input[type='text'][name='nominee_dob']").val(family_detail[0].policy_mem_dob);}}}});}
$(document).on("click","#modal-submit",function()
{if($("input[name='radio_option']:checked").val()==undefined)
{swal("please select at least one member");return false;}
$.ajax({url:"/tele_nominee_family_details",type:"POST",data:{family_id:$("input[name='radio_option']:checked").val(),},async:false,dataType:"json",success:function(response)
{if(response.length!=0)
{$("#nominee_fname").val(response.policy_member_first_name.toUpperCase());$("#nominee_lname").val(response.policy_member_last_name.toUpperCase());$("#nominee_gender").val(response.policy_mem_gender);$("input[type='text'][name='nominee_dob']").val(response.policy_mem_dob);}
$("#myModal").modal("hide");}});});function sortNumber(a,b)
{return a-b;}
function sortSumInsures(id,opt)
{var selVal=$("#"+id+" : selected").val();var vals=$(opt).map(function(){if(this.value){return this.value};}).get();vals.sort(sortNumber);var str=[];str.push(opt[0]);for(i=0;i<vals.length;++i)
{str.push($("#"+id+" option[value="+vals[i]+"]")[0]);}
$("#"+id).empty();$("#"+id).append(str);$("#"+id).val(selVal);$("#"+id).change();}
$("#getMaxPremiumAgeForm").validate({ignore:".ignore",rules:{getMaxPremiumAge:{required:true,number:true},},messages:{},submitHandler:function(form)
{var policyNo=$("#sum_insures :selected").attr("data-policyno");var sum_insures=$("#sum_insures").val();var familyConstruct=$("#patFamilyConstruct").val();var maxPremiumAge=$("#getMaxPremiumAge").val();$.post("/get_premium_age_tele",{"policyNo":policyNo,"sum_insures":sum_insures,"familyConstruct":familyConstruct,"maxPremiumAge":maxPremiumAge},function(e){e=JSON.parse(e);$("#premium").val("");if(e.status=='success')
{$("#premium").val(e.premium);$('#getMaxPremiumAgeModal').modal('hide');}
else
{swal("Alert",e.message,"warning");}})}});$("select[name='familyConstruct']").on("change",function()
{var plan_name=$("#plan_name").val();if(plan_name=='T03'||plan_name=='T01'){console.log(show_popup_new);console.log($('#sum_insures').val());console.log($('#patFamilyConstruct').is('[disabled=disabled]'));console.log($('#patFamilyConstruct').val());if(show_popup_new==0&&$('#sum_insures').val()!=''&&(!$('#patFamilyConstruct').is('[disabled=disabled]')&&$('#patFamilyConstruct').val()!='')){$.ajax({url:"/tele/get_employee_data_new",type:"POST",async:false,data:{"emp_id":$('#empidaxistele').val()},dataType:"json",success:function(response){if(response.spouse_dob){$("#spouse_date_birth").val(response.spouse_dob);}
if(response.kid1_dob){$("#kid1_date_birth").val(response.kid1_dob);}
if(response.kid2_dob){$("#kid2_date_birth").val(response.kid2_dob);}
$("#kid1_rel").val(response.kid1_rel);$("#kid2_rel").val(response.kid2_rel);}});var cons=$(this).val().split("+");var adultCount=0;var kidCount=0;if(cons[0]=='1A'){adultCount=1;$(".check_adult").show();}else{adultCount=2;$(".spouse_div").show();$(".check_adult").hide();}
if(cons[1]!=undefined){if(cons[1]=='1K'){kidCount=1;}else{kidCount=2;}}
if($(this).val()=='2A+1K'){$(".spouse_div").show();$(".kid1_div").show();$(".kid2_div").hide();$(".check_adult").hide();}else if($(this).val()=='2A+2K'){$(".spouse_div").show();$(".kid1_div").show();$(".kid2_div").show();$(".check_adult").hide();}else if($(this).val()=='1A+1K'){$(".spouse_div").hide();$(".kid1_div").show();$(".kid2_div").hide();$(".check_adult").show();}else if($(this).val()=='1A+2K'){$(".spouse_div").hide();$(".kid1_div").show();$(".kid2_div").show();$(".check_adult").show();}else if($(this).val()=='2A'){$(".spouse_div").show();$(".kid1_div").hide();$(".kid2_div").hide();$(".check_adult").hide();}else{$(".check_adult").show();$(".spouse_div").hide();$(".kid1_div").hide();$(".kid2_div").hide();}
$("#helathproXlFamilyModal").modal("show");if(plan_name=='T01'){var mymodal=$('#helathproXlFamilyModal');mymodal.find('.header-title').text('Health Pro');}else if(plan_name=='T03'){var mymodal=$('#helathproXlFamilyModal');mymodal.find('.header-title').text('Health Pro Infinity');}
var deductable=$('#hidden_deductable').val();var hidden_policy_id=$('#hidden_policy_id').val();}else{var famCons=$(this).val();var cons=famCons.split("+");var count=parseInt(cons[0]);if(cons[1]!=undefined){count=count+parseInt(cons[1]);}
if(count!=$('.commonCls').length)
$.ajax({url:"/tele/get_employee_data_new",type:"POST",async:false,data:{"emp_id":$('#empidaxistele').val()},dataType:"json",success:function(response){var membersCovered=[];if(cons[0]=='1A'&&response.policy_for==0){membersCovered.push(0);}
if(cons[0]=='1A'&&response.policy_for==1){membersCovered.push(1);}
if(cons[0]=='2A'){membersCovered.push(0);membersCovered.push(1);}
if(cons[1]!=undefined){if(cons[1]=='1K'){membersCovered.push(response.kid1_rel);}
if(cons[1]=='2K'){membersCovered.push(response.kid1_rel);membersCovered.push(response.kid2_rel);}}
if(response.spouse_dob){$("#spouse_date_birth").val(response.spouse_dob);}
if(response.kid1_dob){$("#kid1_date_birth").val(response.kid1_dob);}
if(response.kid2_dob){$("#kid2_date_birth").val(response.kid2_dob);}
$("#kid1_rel").val(response.kid1_rel);$("#kid2_rel").val(response.kid2_rel);var allowedRel=[0,1,2,3];$.each(allowedRel,function(index,value){if(membersCovered.toString().indexOf(value)==-1){$("#family_members_id1 option[value='"+value+"']").hide();}else{$("#family_members_id1 option[value='"+value+"']").show();}});}});}}else{if($(this).val()){var sumInsuresType=$("#sum_insures :selected").attr("data-type");if($('.commonCls').length>0){apply_button();console.log('---->'+deletecalled);if(deletecalled==0){if(famconsCount>=memberCount){swal("Alert","Below Member Details Section would get modified or deleted. Press OK to Proceed","warning");}else{famconsCount++;}}else{deletecalled=0;}}
if(sumInsuresType=="memberAge"){getPremiumByAge("patFamilyConstruct");}
var family_construct=$('#patFamilyConstruct option:selected').val();var result=family_construct.split('+');var add_length=[];add_length.push(parseInt(result[0]));add_length.push(parseInt(result[1]));if(!$('#patFamilyConstruct').is('[disabled=disabled]')){var boxlen=$('.commonCls').length;var icount;if(boxlen==''){icount=0}else{icount=0+boxlen;}
for(i=icount;i<sum(add_length);i++){common_append(i);}
$("#add_btn_view").show();}
if($('select[name=sum_insure]').val()!=''&&$('select[name=sum_insure] :selected').attr("data-policyno")!=''&&$('select[name=familyConstruct]').val()!=''&&$('#plan_name').val()!=''){$.post("/tele_get_premium",{"sum_insured":$('select[name=sum_insure]').val(),"policy_detail_id":$('select[name=sum_insure] :selected').attr("data-policyno"),"deductable":$('#hidden_deductable').val(),"family_construct":$('select[name=familyConstruct]').val(),"gci_optional":$('input[name=GCI_optional]:checked').val(),"product_id":$('#plan_name').val()},function(e)
{$("#premiumModalHidden").val(e);e=JSON.parse(e);var premium=0;$("#premiumModalBody").html("");var str='';e.forEach(function(e1){str+="<div style='display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;'><div><span style='color:#da8085;'> Name:  "+"<br/></span><span style='color:#000;'>"+e1.policy_sub_type_id+"</span></div>";str+="<div><span style='color:#da8085;'> Sum Insured </span>"+"<br/><span style='color:#000;'>"+e1.sum_insured+"</span></div>";str+="<div><span style='color:#da8085;'> Premium"+"</span><br/><span style='color:#000;'>"+parseFloat(e1.PremiumServiceTax).toFixed(2)+"</span></div></div>";$("#premiumModalBody").append(str);premium+=parseFloat(e1.PremiumServiceTax);});if(str!=''){get_premium=str;$('#premiumModalBody').html(str);}
$("#premium").val(premium.toFixed(2));if(parseInt(premium)!=0&&!isNaN(premium)){total_premium=premium;$('#premium').val(premium);}});}}}
getRelation();});function sum(input){if(toString.call(input)!=="[object Array]")
return false;var total=0;for(var i=0;i<input.length;i++){if(isNaN(input[i])){continue;}
total+=Number(input[i]);}
return total;}
function addDependentForm(tbody,elem)
{var famrelarr=[];var addDependent=null;var premium_ghi=premium_gpa=premium_vtl=ind_premium=0;$("#add_more").empty();var i=0;var length=0;var members_arr=[];elem.data.forEach(function(e)
{if(e['policy_sub_type_id']==1){members_arr.push(e['fr_id']);}
if(e.policy_sub_type_id==1)
{premium_ghi=parseFloat(e.policy_mem_sum_premium);}
if(e.policy_sub_type_id==2)
{premium_gpa+=parseFloat(e.policy_mem_sum_premium);}
if(e.policy_sub_type_id==3)
{premium_vtl+=parseFloat(e.policy_mem_sum_premium);ind_premium=e.policy_mem_sum_premium;}
if(!famrelarr.includes(e['family_relation_id'])){famrelarr.push(e['family_relation_id']);common_append(i,e);if(e.message)
{addDependent={"message":e.message,"premium":e.new_premium,}}
var family_members_id=$("#family_members_id"+i)
var family_salutation=$("#family_salutation"+i)
var family_gender=$("#family_gender"+i)
var first_name=$("#first_name"+i)
var last_name=$("#last_name"+i)
var family_date_birth=$("#family_date_birth"+i)
var age=$("#age"+i)
var age_type=$("#age_type"+i)
var mem_email_id=$("#mem_email_id"+i)
var mem_mob_no=$("#mem_mob_no"+i)
if(e.firstname==''||e.firstname==undefined){e.firstname=e.policy_member_first_name;}
if(e.lastname==''||e.lastname==undefined){e.lastname=e.policy_member_last_name;}
if(e.gender==''||e.gender==undefined){e.gender=e.policy_mem_gender;}
if(e.dob==''||e.dob==undefined){e.dob=e.policy_mem_dob;}
family_members_id.val(e.fr_id);family_members_id.css("pointer-events",'none');family_gender.val(e.gender);first_name.val(e.firstname.toUpperCase()).prop('disabled',true);if(e.lastname!=undefined){last_name.val(e.lastname.toUpperCase()).prop('disabled',true);}else{last_name.val(e.lastname).prop('disabled',true);}
family_date_birth.val(e.dob).prop('disabled',true);age.val(e.age);if(e.fr_id!=1&&e.fr_id!=0&&e.fr_id!=2&&e.fr_id!=3)
{salutation_hide_show(this,e.policy_mem_gender);family_salutation.prop('disabled',false);}
else
{family_salutation.prop('disabled',true);}
set_salutation(family_salutation,e.fr_id);age_type.val(e.age_type);mem_email_id.val(e.policy_member_email_id);mem_mob_no.val(e.policy_member_mob_no);mem_email_id.val(e.policy_member_email_id).prop('disabled',true);mem_mob_no.val(e.policy_member_mob_no).prop('disabled',true);declarepopoulate(e.emp_id,e.policy_member_id,i);if(e.fr_id!='0'){$("#edit_btn"+i).show();}
if(e.fr_id==2||e.fr_id==3){$("#mem_email_id"+i).parent().hide();$("#mem_mob_no"+i).parent().hide();$("#mem_email_id"+i).attr('required',false);$("#mem_mob_no"+i).attr('required',false);}
if($("#plan_name").val()=='R06'){$("#edit_btn"+i).show();}
$("#delete_btn"+i).show();$("#delete_btn"+i).html('Delete');$(".disease"+i).css("pointer-events","none");i++;}});var family_construct=$('#patFamilyConstruct option:selected').val();if(family_construct!=''){var result=family_construct.split('+');var add_length=[];add_length.push(parseInt(result[0]));add_length.push(parseInt(result[1]));debugger;if(sum(add_length)>members_arr.length){var check_count=(sum(add_length)-members_arr.length);var i=0;var x=members_arr.length;for(i=0;i<check_count;i++){common_append(x++);}}
$("#add_btn_view").show();if(sum(add_length)==elem.data.length){}
if(elem.data.length==0)
{$("#add_more").empty();$("#add_btn_view").hide();$("#sum_insures").val('');$("#patFamilyConstruct").val('');$("select[name=familyConstruct]").html('<option value="" selected>Select</option>');$("#premium").val('');$("#plan_name").removeAttr('disabled','disabled');if($('#plan_name').val()=='T03'){$("#sum_insures").removeAttr("disabled","disabled");$("#patFamilyConstruct").removeAttr("disabled","disabled");}}}
if(addDependent&&addDependent.message&&addDependent.premium)
{swal("Alert",addDependent.message,"warning");$("#premium").val(addDependent.premium)}
if($('#plan_name').val()!=''&&$("#sum_insures").val()!=''){var premHtml='';if(premium_ghi!=0){premHtml+='<div style="display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;"><div><span style="color:#da8085;"> Name:  <br></span><span style="color:#000;">Group Health Insurance</span></div><div><span style="color:#da8085;"> Sum Insured </span><br><span style="color:#000;">'+$("#sum_insures").val()+'</span></div><div class="mr-3"><span style="color:#da8085;"> Premium</span><br><span style="color:#000;">'+premium_ghi+'</span></div></div>';}
if(premium_gpa!=0){premHtml+='<div style="display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;"><div><span style="color:#da8085;"> Name:  <br></span><span style="color:#000;">Group Personal Accident</span></div><div><span style="color:#da8085;"> Sum Insured </span><br><span style="color:#000;">'+$("#sum_insures").val()+'</span></div><div class="mr-3"><span style="color:#da8085;"> Premium</span><br><span style="color:#000;">'+premium_gpa+'</span></div></div>';}
if(premium_vtl!=0){if($('#plan_name').val()=='T01'){premHtml+='<div style="display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;"><div><span style="color:#da8085;"> Name:  <br></span><span style="color:#000;">Group Critical Insurance</span></div><div><span style="color:#da8085;"> Sum Insured </span><br><span style="color:#000;">'+$("#sum_insures").val()+'</span></div><div class="mr-3"><span style="color:#da8085;"> Premium</span><br><span style="color:#000;">'+premium_vtl+'</span></div></div>';var gci_premium=premium_vtl;}else{premHtml+='<div style="display: flex; flex-direction:row; justify-content:space-between; padding-top:10px;"><div><span style="color:#da8085;"> Name:  <br></span><span style="color:#000;">Group Critical Insurance</span></div><div><span style="color:#da8085;"> Sum Insured </span><br><span style="color:#000;">'+$("#sum_insures").val()+'</span></div><div class="mr-3"><span style="color:#da8085;"> Premium</span><br><span style="color:#000;">'+premium_vtl+'</span></div></div>';var gci_premium=premium_vtl;}}
if(premHtml!=''){get_premium=premHtml;$('#premiumModalBody').html(premHtml);}
var totalPremium=parseInt(premium_ghi)+parseInt(premium_gpa)+parseInt(gci_premium);if(parseInt(totalPremium)!=0&&!isNaN(totalPremium)){total_premium=totalPremium;$('#premium').val(totalPremium);$('#premium').text(totalPremium);}}else{get_premium='';total_premium=0;$("#premium").val('0');$("#premiumModalBody").html("");$("#sum_insures").val();}}
function common_append(j,e=''){var is_maker_checker=$('#checker_edit').val();var new_fileds='<div class="col-md-3" style="display:none;"><div class="form-group"><label for="example-text-input" class="col-form-label">Email ID <span style="color:#FF0000">*</span></label><input class="form-control mem_email_id sahil ignore mem_email_id1" type="text" value="" id="mem_email_id'+j+'" name="mem_email_id[]" autocomplete="off" maxlength="50"></div></div><div class="col-md-3" style="display:none;"><div class="form-group"><label for="example-text-input" class="col-form-label">Mobile No <span style="color:#FF0000">*</span></label><input class="form-control mem_mob_no1 sahil ignore" type="text" maxlength="10" value="" id="mem_mob_no'+j+'" name="mem_mob_no[]" autocomplete="off" maxlength="50"></div></div>';if($('#plan_name').val()=='T03'){var new_fileds='<div class="col-md-3"><div class="form-group"><label for="example-text-input" class="col-form-label">Email ID <span style="color:#FF0000">*</span></label><input class="form-control mem_email_id sahil mem_email_id1" type="text" value="" id="mem_email_id'+j+'" name="mem_email_id[]" autocomplete="off" maxlength="50" required></div></div><div class="col-md-3"><div class="form-group"><label for="example-text-input" class="col-form-label">Mobile No <span style="color:#FF0000">*</span></label><input class="form-control mem_mob_no1 sahil" maxlength="10" type="text" value="" id="mem_mob_no'+j+'" name="mem_mob_no[]" autocomplete="off" maxlength="50" required></div></div>';}
var is_delete='';if(is_maker_checker=='no'){is_delete='<button class="btn sub-btn hide_proposal del_btn_member" style="background: #E53935 !important;border: none;padding: 5px 15px;" id ="delete_btn'+j+'" type="button" data-emp-id='+e.emp_id+' data-policy-member-id='+e.policy_member_id+' onclick="deleteMember('+j+')">Clear</button>';}
var add_div_new='<div class="row mt-2 mb-2 divmem'+j+'"><div class="col-md-10">Member '+(j+1)+'</div><div class="col-md-2 text-center"><button class="btn sub-btn hide_proposal" style="margin-right: 4px; background: #FB8C00 !important;border: none;padding: 5px 15px; display:none;" id ="edit_btn'+j+'" type="button" onclick="editMember('+j+')">Edit</button>'+is_delete+'</div></div>';var add_div='<div class="col-md-3"><div class="form-group"><label class="col-form-label">Relation With Proposer<span style="color:#FF0000">*</span></label><select class="form-control family_members_id1" id ="family_members_id'+j+'" name="family_members_id[]" onchange="changes(this);"><option value="" >Select</option></select></div></div><div class="col-md-1"><div class="form-group"><label class="col-form-label">Salutation<span style="color:#FF0000">*</span></label><select class="form-control family_salutation" id ="family_salutation'+j+'" name="family_salutation[]" style="padding: 5px 0px; font-size: 13px !important;"><option value="" >Select</option><option value="Mr" class="male_gen">Mr</option><option value="Mrs" class="female_gen">Mrs</option><option value="Ms" class="female_gen">Ms</option><option value="Master" class="male_gen">Master</option></select></div></div><div class="col-md-2"><div class="form-group"><label class="col-form-label">Gender<span style="color:#FF0000">*</span></label><input class="form-control family_gender dis-col" type="text" id ="family_gender'+j+'" name="family_gender[]" id="family_gender1" readonly><p class="p-gender">Auto selected basis salutation value opted.</p></div></div><div class="col-md-3"><div class="form-group"><label for="example-text-input" class="col-form-label">First Name <span style="color:#FF0000">*</span></label><input class="form-control first_name commonCls sahil" type="text" value="" id ="first_name'+j+'" name="first_name[]" autocomplete="off" maxlength = "50" ></div></div><div class="col-md-3"><div class="form-group"><label for="example-text-input" class="col-form-label">Last Name </label><input class="form-control last_name" type="text" value="" id ="last_name'+j+'" name="last_name[]" maxlength = "50" autocomplete="off" ><span id="err_last_nameArr" class="error"></span></div></div><div class="col-md-3"><div class="form-group"><label for="example-date-input" class="col-form-label">Date of Birth<span style="color:#FF0000">*</span></label><input class="form-control family_date_birth" autocomplete="off" type="text" id ="family_date_birth'+j+'" name="family_date_birth[]" readonly="readonly"><span id="err_family_date_birthArr" class="error"></span></div></div><div class="col-md-3" style="display: block" ><div class="form-group"><label for="example-text-input" class="col-form-label">Age (days/years)<span style="color:#FF0000">*</span></label><input class="form-control dis-col age1" type="text" id ="age'+j+'" name="age[]" readonly=""></div></div>'+new_fileds+'<div class="col-md-3" style="display: none"><div class="form-group"><label for="example-text-input" class="col-form-label">Age Type (Year(s)/Day(s)) <span style="color:#FF0000">*</span></label><input type="text" class="form-control age_type1" id ="age_type'+j+'" name="age_type[]" readonly=""></div></div><div class="col-md-12 disease'+j+'" style="display: block"><div class="member_declare_benifit_4s'+j+' col-md-12"></div><div class="tt quest_declare_benifit_4s'+j+' col-md-12"></div><input type="hidden" name="edit_member_id[]" value='+e.policy_member_id+'></div>';var div=$("<div />");var div_new=$("<div />");div_new.html("<div>"+add_div_new);div.html('<div class="col-md-12 bor-rr row mb-2 divmem'+j+' ">'+add_div);$("#add_more").append(div_new);$("#add_more").append(div);selectChange=$("#family_members_id"+j).closest("form");var sumInsuresType=selectChange.find('select[name=sum_insure] :selected').attr("data-type");var family_construct=selectChange.find('select[name=familyConstruct]');$(".family_date_birth").datepicker({dateFormat:"dd-mm-yy",prevText:'<i class="fa fa-angle-left"></i>',nextText:'<i class="fa fa-angle-right"></i>',changeMonth:true,changeYear:true,yearRange:"-100Y:+1D",maxDate:"-1D",minDate:"-56Y +1D",onSelect:function(dateText,inst)
{$(this).val(dateText);var selectChange=$(this).closest(".row");get_age(dateText,selectChange);}});$.ajax({url:"/tele_policy_data",type:"POST",data:{},async:false,dataType:"json",success:function(response)
{$("#benifit_4s").css("display","block");var i;for(i=0;i<response.length;i++)
{$("#hidden_policy_section").val(1);$("#pr_name").html(response[i].product_name);$("#pr_name").html('Axis Tele Inbound Affinity Portal for ABHI');$("#master_policy_number").val(response[i].master_policy_no);if(response[i].policy_sub_type_id==1)
{$(".personal_accident").text(response[i].policy_sub_type_name);$("#benifit_4s").css("display","block");$("#subtype_text").val(response[i].policy_sub_type_id);if((response[i].max_adult>1&&response[i].fr_id==1)||response[i].fr_id==0)
{$("#family_members_id"+j).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}
else if(response[i].max_adult==2&&response[i].max_child==0&&(response[i].fr_id==4||response[i].fr_id==5||response[i].fr_id==6||response[i].fr_id==7))
{$("#family_members_id"+j).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}
else if(response[i].max_adult==4&&response[i].max_child==0&&response[i].fr_id==5||response[i].fr_id==6||response[i].fr_id==7)
{$("#family_members_id"+j).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}
else if(response[i].max_adult>2&&(response[i].fr_id==4||response[i].fr_id==5||response[i].fr_id==6||response[i].fr_id==7||response[i].fr_id==1||response[i].fr_id==0))
{$("#family_members_id"+j).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}
else if(response[i].fr_id==2||response[i].fr_id==3)
{$("#family_members_id"+j).append('<option data-opt="'+response[i].gender_option+'" value="'+response[i].fr_id+'">'+response[i].fr_name+"</option>");}}}}});if(sumInsuresType=="family_construct")
{getPremium(selectChange);if(get_premium!=''){$('#premiumModalBody').html(get_premium);}
getRelation();}else if(sumInsuresType=="family_construct_age")
{if($('#plan_name').val()!='T03'){getPremiumByAge(family_construct);}}
if($('#plan_name').val()=='R06'){$.ajax({url:"/tele_member_declare_data",type:"POST",dataType:"html",data:{member_id:j},success:function(response)
{$(".member_declare_benifit_4s"+j).html(response)}});}
if($('#plan_name').val()=='T03'){getRelation();}}
function set_salutation(elem,val){var salutation_set='';$.ajax
({url:"/tele_family_details",type:"POST",data:{relation_id:0},dataType:"json",async:false,beforeSend:function(){set_session();},success:function(response)
{salutation_set=response.family_data[0].salutation;if(response.family_data[0].product_id=='T01'){$(".GCIOptionalDiv").show();if(response.family_data[0].GCI_optional=='No'){$('#GCI_no').prop('checked',true);}else{$('#GCI_yes').prop('checked',true);}}
$('#annual_income').val(response.family_data[0].annual_income);$('#occupation').val(response.family_data[0].occupation);}});if(val==0){elem.val(salutation_set);}else{if(val==1){if(salutation_set=='Mr'){elem.val('Mrs');}else{elem.val('Mr');}}else{if(val==2){elem.val('Master');}else{elem.val('Ms');}}}}
function editMember(i)
{var is_maker_checker=$('#checker_edit').val();if($("#family_members_id"+i).val()==0){if(proposal_created==1){swal({title:"Alert",text:"SELF can be modified in CUSTOMER DETAILS section only.",type:"warning",showCancelButton:true,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){setTimeout(function(){$('#firstname').focus();},2000);$('#self_edit_clicked').val(1);$("#edit_btn_custsection").trigger("click");return false;});}else{if($("#family_members_id"+i).val()!=''){swal({title:"Alert",text:"SELF can be modified in CUSTOMER DETAILS section only. This would auto-delete Member details of SELF to be refilled by USER",type:"warning",showCancelButton:true,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){$('.cust_div_col').removeClass("collapsed");$('#accordion223').removeClass("collapsing");$('#accordion223').addClass("collapse show");setTimeout(function(){$('#firstname').focus();},2000);$('#self_edit_clicked').val(1);$("#edit_btn_custsection").trigger("click");return false;});}}}else{if(proposal_created==1){$("#first_name"+i).prop('disabled',false);$("#last_name"+i).prop('disabled',false);$("#mem_email_id"+i).prop('disabled',false);$("#mem_mob_no"+i).prop('disabled',false);}else{$("#first_name"+i).prop('disabled',false);$("#last_name"+i).prop('disabled',false);if(is_maker_checker=='no'){$("#family_date_birth"+i).prop('disabled',false);}
$("#edit_btn"+i).hide();$("#patFormSubmit").show();$(".disease"+i).css("pointer-events","auto");$("#mem_email_id"+i).prop('disabled',false);$("#mem_mob_no"+i).prop('disabled',false);$("#first_name"+i).focus();if($("#plan_name").val()=='R06'&&$("#family_members_id"+i).val()==0){$("#first_name"+i).prop('disabled',true);$("#last_name"+i).prop('disabled',true);if(is_maker_checker=='no'){$("#family_date_birth"+i).prop('disabled',true);}}}}}
function deleteMember(i)
{set_session();var mem_id=$("#delete_btn"+i).data("policy-member-id");if(mem_id!="undefined"){$.ajax({url:"/tele_delete_member",type:"POST",async:false,data:{'emp_id':$("#delete_btn"+i).attr("data-emp-id"),'policy_member_id':$("#delete_btn"+i).attr("data-policy-member-id")},success:function(e)
{debugger;var e=e.trim();if(!e)
{$("#delete_btn"+i).closest("form").find("select[name='family_members_id[]']").css("pointer-events",'auto')
swal("Success","Member Deleted Successfully","success");$(".quest_declare_benifit_4s").empty();$('#chronic th input[type="checkbox"]').prop('checked',false);get_all_data('deletecalled');$("#patFormSubmit").show();common_append(i);}}});}else{if(($("#patFamilyConstruct").val()!=''||$("#patFamilyConstruct").val()!=undefined)&&($("#sum_insures").val()!=''||$("#sum_insures").val()!=undefined)){var strcon=$("#patFamilyConstruct").val();if(strcon.indexOf('+')>-1)
{var res=strcon.split("+");count=0;if(res[0]!=''||res[0]!=undefined){count=count+parseInt(res[0].replace('A',''));}
if(res[1]!=''||res[1]!=undefined){count=count+parseInt(res[1].replace('K',''));}}else{count=parseInt(strcon.replace('A',''));}
var divCount=$('.commonCls').length;if(divCount!=count){$('.divmem'+i).parent().remove();}else{$('#family_members_id'+i).val('');$('#family_salutation'+i).val('');$('#family_gender'+i).val('');$('#first_name'+i).val('');$('#last_name'+i).val('');$('#last_name'+i).val('');$('#family_date_birth'+i).datepicker('setDate',null);$('#age'+i).val('');$('#mem_email_id'+i).val('');$('#mem_mob_no'+i).val('');}}}
if($('.commonCls').length==0){$('#hidden_deductable').val('');$('#hidden_policy_id').val('');show_popup_new=0;}}
function declarepopoulate(emp_edit_id,emp_edit_policy_mem,j='')
{$.post('/tele_subtype_id',{'emp_edit_id':emp_edit_id,'emp_policy_mem':emp_edit_policy_mem,},function(e)
{var obj=JSON.parse(e);if(obj!=null)
{var len=obj.length;var i;for(i=0;i<len;i++){var member=obj[i];if(member.declare_sub_type_id)
{$("#subdeclare_"+member.declare_sub_type_id+j).prop("checked",true);get_sub_data(member.declare_sub_type_id,j);}
else
{$("#subdeclare_"+member.declare_sub_type_id+"_1"+j).prop("checked",true);}}}});$.ajax({url:"/tele_ghd_emp_declare",type:"POST",async:false,data:{'emp_edit_id':emp_edit_id,'emp_policy_mem':emp_edit_policy_mem},dataType:"json",success:function(response)
{var obj=response;if(obj!=null&&obj.length>1)
{var len=obj.length;var i;for(i=0;i<len;i++)
{var member=obj[i];if(member.format)
{if((member.type=='C1'&&member.format=='No')||(member.type=='C2'&&member.format=='No'))
{$("#C_data").show();}
if((member.type=='D1')||(member.type=='D2')||(member.type=='D3')||(member.type=='D4'))
{$("#D_data").show();}
if((member.type=='E'&&member.format=='No')||(member.type=='E'&&member.format=='Yes'))
{$("#E_data").show();}
if(member.format=='Yes')
{$("#"+member.type+"_remark").show();$("#"+member.type+"_remark").val(member.remark);$("#"+member.type+"_1").prop("checked",true);}
else
{$("#"+member.type+"_2").prop("checked",true);}}}}}});}
function setFamilyConstruct(value,eventcheck='')
{var tax_with_premium=$("#sum_insures option:selected").data("id");if($("#sum_insures :selected").attr("data-type")=="family_construct"||$("#sum_insures :selected").attr("data-type")=="family_construct_age"||$("#sum_insures :selected").attr("data-type")=="combo_diff_construct")
{var PremiumServiceTax;$.ajax({url:"/tele_family_construct",type:"POST",async:false,data:{"policyNo":$("#sum_insures :selected").attr("data-policyno"),"sumInsured":$("#sum_insures :selected").val(),"table":$("#sum_insures :selected").attr("data-type"),},beforeSend:function(){set_session();},success:function(e)
{$("#patFamilyConstruct").empty();$("#patFamilyConstruct").html('<option value="" selected>Select</option>');e=JSON.parse(e);console.log(e);console.log(e.status);if(e.status=='error'){swal("error",m.msg,"warning");}else{e=e.data;$("#patFamilyConstructDiv").show();if(e)
{e.forEach(function(e1)
{PremiumServiceTax=e1.PremiumServiceTax;$("#patFamilyConstruct").append("<option value='"+e1.family_type+"' data-premium='"+PremiumServiceTax+"'>"+e1.family_type+"</option>");});if(value)
{$("#patFamilyConstruct").val(value);}
var is_edit=$("input[name='edit']").val();if(value&&is_edit==0)
{if(eventcheck=='deletecalled'){deletecalled=1;}
$("#patFamilyConstruct").change();}}}}});apply_button();}
else
{$("#patFamilyConstructDiv").hide();}}
function setMasPolicy(type,e1){var policy=e1["policy_sub_type_id"]==1?"policy_no":e1["policy_sub_type_id"]==2?"policy_no2":"policy_no3";var id=e1["policy_sub_type_id"]==1?"sum_insures":e1["policy_sub_type_id"]==2?"sum_insure":"sum_insures1";$("#"+policy).val(e1["policy_detail_id"]);if(type=="flate"){var sumInsured=e1["sum_insured"].split(",");var PremiumServiceTax=e1["PremiumServiceTax"].split(",");for(k=0;k<sumInsured.length;++k){$("#"+id).append("<option data-type='"+type+"' data-policyNo='"+e1["policy_detail_id"]+"' data-customer = '"+
premium[k]+"'  data-id = '"+
PremiumServiceTax[k]+"' family_child= '"+
e1.child+"' family_adult= '"+
e1.adult+"' value ="+
sumInsured[k]+">"+
sumInsured[k]+"</option>");}}else{if(type=="memberAge"){$("#patFamilyConstructDiv").hide();e1["PremiumServiceTax"]=e1["premium"];}
$("#"+id).append("<option data-type='"+type+"' data-policyNo='"+e1["policy_detail_id"]+"' data-customer = '"+e1.premium+"'  data-id = '"+e1.PremiumServiceTax+"' family_child= '"+e1.child+"' family_adult= '"+e1.adult+"' value ="+e1.sum_insured+">"+e1.sum_insured+"</option>");}}
function get_all_data(eventcheck='')
{proposal_create_check();$.ajax({url:"/tele_get_all_data",type:"POST",dataType:"json",data:{product_id:$('#plan_name').val()},beforeSend:function(){set_session();},success:function(response)
{if(response.data==''||jQuery.isEmptyObject(response.data)){get_premium='';total_premium=0;$("#premium").val('0');$("#premiumModalBody").html("");$("#sum_insures").val();$("#hidden_policy_section").val(0);$('#hidden_deductable').val('');$('#hidden_policy_id').val('');show_popup_new=0;}else{if(eventcheck!=''){memberCount=response.data.length+2;}else{memberCount=response.data.length;}
$("#plan_name").attr("disabled","disabled");if($('#plan_name').val()=='T03'){$("#sum_insures").attr("disabled","disabled");$("#patFamilyConstruct").attr("disabled","disabled");}
show_popup=1;show_popup_new=1;}
$("#premium1").attr("disabled","disabled");var patFamilyConstruct=$("#patFamilyConstruct").val();var sum_insures=$("#sum_insures").val();if(sum_insures=='')
{$("#plan_name").removeAttr("disabled","disabled");if($('#plan_name').val()=='T03'){$("#sum_insures").removeAttr("disabled","disabled");$("#patFamilyConstruct").removeAttr("disabled","disabled");}}
var premium1=$("#premium1").val();$("#premium1").val(premium1);if(response.constructor==String)
{addDependentForm("vtlTable",JSON.parse(response));}
else
{var patTable={};patTable.data=[];var vtlTable={};vtlTable.data=[];var premAmt=0;var cntelem=0;debugger;for(var i=0;i<response.data.length;i++)
{if(response.data[i]['policy_mem_sum_insured']>1000000){$("#annual_income_label").show();$("#occupation_label").show();$("#annual_income").removeClass("ignore");$("#occupation").removeClass("ignore");}else{$("#annual_income_label").hide();$("#occupation_label").hide();$("#annual_income").addClass("ignore");$("#occupation").addClass("ignore");}
if(response.data[i]['policy_sub_type_id']==3)
{$("#sum_insures1").val(response.data[i]['policy_mem_sum_insured']);$('#premium1').val(response.data[i]['policy_mem_sum_premium']);}
else if(response.data[i]['policy_sub_type_id']==1)
{membersCovered.push(response.data[i]['fr_id']);$("#sum_insures").val(response.data[i]['policy_mem_sum_insured']);$('#premium').val(response.data[i]['policy_mem_sum_premium']);setFamilyConstruct(response.data[i]['familyConstruct'],eventcheck);if(premAmt==0){premAmt=parseFloat(response.data[i]['policy_mem_sum_premium']);}
cntelem++;}
else if(response.data[i]['policy_sub_type_id']==2)
{premAmt=premAmt+parseFloat(response.data[i]['policy_mem_sum_premium']);}}
for(var i=0;i<response.data.length;i++)
{if(response.data[i]['policy_sub_type_id']==3)
{vtlTable.data.push(response.data[i]);}
else if(response.data[i]['policy_sub_type_id']==2)
{vtlTable.data.push(response.data[i]);}
else if(response.data[i]['policy_sub_type_id']==1)
{vtlTable.data.push(response.data[i]);}}
if($('#hidden_policy_id').val()==TELE_HEALTHPROINFINITY_GHI_GPA){$('.occupation_label').show();$('#occupation').removeClass('ignore');$("#annual_income_label").show();annual_income_hide_show();}else{$('.occupation_label').hide();$('#occupation').addClass('ignore');$("#annual_income_label").hide();annual_income_hide_show();}
addDependentForm("patTable",vtlTable);if($('#plan_name').val()=='T03'){if(cntelem==$('.commonCls').length){$('#premium').val(premAmt);}}}
if(eventcheck=='deletecalled'){deletecalled=1;}
$("#patFamilyConstruct").trigger("change");if(response.data!=''||!jQuery.isEmptyObject(response.data)){proposal_create_check();}
if($('#plan_name').val()=='T01'){getPremiumNew();}}});}
function otp_generate()
{$("#myModal1").modal("hide");$("#sms_body").html('');ajaxindicatorstop();$.ajax({url:"/tele_send_otp",type:"POST",data:{},async:false,dataType:"json",success:function(response)
{$("#pos_otp").val("");$("#myModal1").modal("show");}});}
$(document).on("click","#validate_otp",function()
{$.ajax({url:"/tele_validate_otp",type:"POST",data:{otp:$("#pos_otp").val()},async:false,dataType:"json",success:function(response)
{ajaxindicatorstart();if(response.status=='true')
{$("#sms_body").html('<p>'+response.message+'</p>')
$("#myModal1").modal("hide");}
else
{ajaxindicatorstop();$("#sms_body").html('<p>OTP validation failed, pls generate it again</p>')
$("#pos_otp").val("");return;}
$("#pos_otp").val("");}});});$(document).on("click","#resend_otp",function()
{otp_generate();});$("#emp_agent_data").validate({ignore:".ignore",focusInvalid:true,rules:{axis_location:{required:true,},axis_vendor:{required:true,},axis_lob:{required:true,},axis_process:{required:true,},agent_id:{required:true,validate_agent:true,},imd_code:{required:true,},},messages:{},invalidHandler:function(form,validator)
{validator.focusInvalid();},submitHandler:function(form)
{set_session();var all_data=$("#emp_agent_data").serialize();$.ajax({url:"/tele_agent_data_insert",type:"POST",data:all_data,async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response)
{var res=response;if(res.status==false)
{ajaxindicatorstop();swal({title:"Alert",text:res.message,type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});return;}
if(res.status==true)
{ajaxindicatorstop();swal({title:"Success",text:"Agent Details Added Successfully",type:"success",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){$("#hidden_agent_section").val(1);});}}});}});$("#emp_data").validate({ignore:".ignore",focusInvalid:true,rules:{salutation:{required:true},firstname:{required:true},gender1:{required:true},dob:{required:true},mob_no:{required:true},comAdd:{required:true},mobile_no2:{valid_mobile:true,},pin_code:{required:true,validate_pincode:true,},city:{required:true,},state:{required:true,},email:{required:true,validateEmail:true,},},messages:{},invalidHandler:function(form,validator)
{validator.focusInvalid();},submitHandler:function(form)
{var agent_details=$("#hidden_agent_section").val();if($('#disposition').val()==45||$('#disposition').val()==46){if(!$("#emp_agent_data").valid())
{ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Agent Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}
else if(!$("#emp_data").valid())
{ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Customer Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}}
else if(agent_details==0){swal({title:"Alert",text:"Please SAVE the values entered so far to proceed with new Section!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});return false;}
var all_data=$("#emp_data").serialize()+"&self_edit_clicked="+$("#self_edit_clicked").val()+"&gender1="+$("#gender1").val()+"&dob="+$("#dob1").val()+"&salutation="+$('#salutation').val();$.ajax({url:"/tele_emp_data_insert",type:"POST",data:all_data,async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response)
{var totalfamily_length=$('.family_members_id1').length;var get_member_check='';for(var i=0;i<=totalfamily_length-1;i++){var member_check=$("#family_members_id"+i).val();if(member_check==0){get_member_check=member_check;}}
var res=response;if(res.update==1&&res.proposal_status=='No')
{if($('#self_edit_clicked').val()==0){swal({title:"Alert",text:"SELF can be modified in CUSTOMER DETAILS section only. This would auto-delete Member details of SELF to be refilled by USER",type:"warning",showCancelButton:true,confirmButtonText:"Ok!",closeOnConfirm:false,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});}
deleteMember(0);$("#self_edit_clicked").val(0);$('#first_name0').focus();}else{$("#family_members_id0").trigger("change");}
if(res.status==false)
{ajaxindicatorstop();swal({title:"Alert",text:res.message,type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});return;}
if(res.status==true)
{ajaxindicatorstop();swal({title:"Success",text:"Customer Details Added Successfully",type:"success",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});var empSalutation=$("#salutation").val();var empGender=$("#gender1").val();if($('#family_members_id1').val()==1){if(empSalutation=='2'||empSalutation=='3'){$('#family_members_id1').val('Mr');}else{$('#family_members_id1').val('Mrs');}
$('#family_members_id1').val(1);}
if($('#family_members_id0').val()==1){if(empSalutation=='2'||empSalutation=='3'){$('#family_members_id0').val('Mr');}else{$('#family_members_id0').val('Mrs');}
$('#family_members_id0').val(1);}
$("#hidden_customer_section").val(1);$('#edit_btn_custsection').show();$('#salutation').attr('disabled',true);$('#firstname').attr('readonly',true);$('#lastname').attr('readonly',true);$('#gender1').attr('disabled',true);$('#dob1').attr('disabled',true);$('#dob1').attr('readonly',true);$('#mob_no').attr('readonly',true);$('#gender1').addClass("dis-col");$('#mob_no').addClass("dis-col");if(is_maker_checker=='yes'){$('#email').attr('readonly',false);$('#email').removeClass("dis-col");}else{$('#email').attr('readonly',true);$('#email').addClass("dis-col");}
$('#mem_email_id'+get_member_check).val($('#email').val());}}});}});$("#nominee_data").validate({ignore:".ignore",focusInvalid:true,rules:{nominee_fname:{required:true,checkspace_nominee:true},nominee_gender:{required:true},nominee_dob:{required:true},nominee_relation:{required:true},nominee_contact:{valid_mobile:true},nominee_salutation:{required:true,},nominee_email:{validateEmail:true,},},messages:{},invalidHandler:function(form,validator)
{validator.focusInvalid();},submitHandler:function(form)
{var agent_details=$("#hidden_agent_section").val();var customer_details=$("#hidden_customer_section").val();var policy_details=$("#hidden_policy_section").val();if($('#disposition').val()==45||$('#disposition').val()==46){if(!$("#emp_agent_data").valid())
{ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Agent Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}
else if(!$("#emp_data").valid())
{ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Customer Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}
else if($('#plan_name').val()==''||$('#sum_insures').val()==''||$('#familyConstruct').val()==''){ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Policy Details",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}}
else if(agent_details==0||customer_details==0||policy_details==0){swal({title:"Alert",text:"Please SAVE the values entered so far to proceed with new Section!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});return false;}
var all_data=$("#nominee_data").serialize()+"&nominee_relation="+$("#nominee_relation").val()+"&nominee_dob="+$('#nomineedob').val()+"&nominee_salutation="+$("#nominee_salutation").val()+"&nominee_contact="+$('#nominee_contact').val()+"&nominee_email="+$("#nominee_email").val();$.ajax({url:"/tele_nominee_data_insert",type:"POST",data:all_data,async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response)
{var res=response;if(res.status==false)
{ajaxindicatorstop();swal({title:"Alert",text:res.message,type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});return;}
if(res.status==true)
{ajaxindicatorstop();swal({title:"Success",text:"Nominee Details Added Successfully",type:"success",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){$('#edit_nominee').show();hideEditButtons();$("#hidden_nominee_section").val(1);});}}});}});$("#payment_details").validate({ignore:".ignore",focusInvalid:true,rules:{disposition:{required:true,},sub_isposition:{required:true,},preferred_contact_date:{required:true,},preferred_contact_time:{required:true,time_validate:true,},},messages:{},submitHandler:function(form)
{var agent_details=$("#hidden_agent_section").val();var customer_details=$("#hidden_customer_section").val();var policy_details=$("#hidden_policy_section").val();var nominee_details=$("#hidden_nominee_section").val();if($('#disposition').val()==45||$('#disposition').val()==46){if(!$("#emp_agent_data").valid())
{ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Agent Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}
else if(!$("#emp_data").valid())
{ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Customer Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}
else if($('#plan_name').val()==''||$('#sum_insures').val()==''||$('#familyConstruct').val()==''){ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Policy Details",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}
else if(!$("#nominee_data").valid())
{ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Nominee Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}
else if(!$("#payment_details").valid()){ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Payment Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}}else{if(!$("#emp_agent_data").valid())
{ajaxindicatorstop();swal({title:"Alert",text:"Please FILL Agent Details!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});return;}}
if(agent_details==0||customer_details==0||policy_details==0||nominee_details==0){swal({title:"Alert",text:"Please SAVE the values entered so far to proceed with new Section!",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});return false;}
var all_data=$("#payment_details").serialize();$.ajax({url:"/tele_payment_details_insert",type:"POST",data:all_data,async:false,dataType:"json",success:function(response)
{debugger;if(response.disabled=='Close'){$("#sub_isposition").attr("disabled",true);$("#disposition").attr("disabled",true);}
$("#payment_details_tbody").html('');var str='';$.each(response.data,function(index,item){str+='<tr><td>'+item.Dispositions+'</td><td> '+(item["Sub-dispositions"])+'</td><td>'+item.date+'</td><td>'+item.agent_name+'</td><td>'+((item.remarks)?item.remarks:'')+'</td><td>'+((item.type)?item.type:'AV')+'</td><</tr>';});$("#payment_details_tbody").html(str);if(proposal_payment_done==0){var not_allowed=["Junk","Not Interested","Not Eligible"];if(not_allowed.indexOf($("#disposition option:selected").text())>-1){$('#edit_payment').hide();}else{$('#edit_payment').show();}}
swal("Success","Payment Details Saved","success");payment_details_submit=false;}});}});$("#proposal_data").validate({ignore:".ignore",focusInvalid:true,rules:{auto_renewal:{required:true,},},messages:{},submitHandler:function(form)
{debugger;set_session();ajaxindicatorstart();if(!$("#payment_details").valid()){ajaxindicatorstop();return;}
if(!$("#emp_agent_data").valid())
{ajaxindicatorstop();return;}
if(!$("#emp_data").valid())
{ajaxindicatorstop();return;}
if(!$("#nominee_data").valid())
{ajaxindicatorstop();return;}
if($('#plan_name').val()=='R06'){var check_ghd_blank=get_blank_validation();}else{check_ghd_blank=true;}
if(check_ghd_blank==false)
{ajaxindicatorstop();swal({title:"Alert",text:"Please select good health declaration",type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function()
{});return;}
var check_ghd=get_remark_validation();if(check_ghd==false)
{return false;}
var mydeclare=$("#mydatas input[type='checkbox']:checked").val();var mydeclare2=$("#mydatas1 input[type='radio']:checked").val();if(mydeclare2=='Yes')
{ajaxindicatorstop();swal("Alert","As the Group Health Declaration Question is Yes, the proposal cannot be processed","warning");$("#myModal1").modal("hide");$("#sms_body").html('');return false;}
if(mydeclare=='No')
{ajaxindicatorstop();swal("Alert","In order to proceed further please check the disclaimer","warning");$("#myModal1").modal("hide");$("#sms_body").html('');return false;}
if(payment_details_submit){var all_data=$("#payment_details").serialize();$.ajax({url:"/tele_payment_details_insert",type:"POST",data:all_data,async:false,dataType:"json",success:function(response)
{}});}
var all_data=$("#emp_agent_data").serialize();$.ajax({url:"/tele_agent_data_insert",type:"POST",data:all_data,async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response)
{}});var all_data=$("#emp_data").serialize()+"&self_edit_clicked="+$("#self_edit_clicked").val()+"&gender1="+$("#gender1").val()+"&dob="+$("#dob1").val()+"&salutation="+$('#salutation').val();$.ajax({url:"/tele_emp_data_insert",type:"POST",data:all_data,async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response)
{}});var all_data=$("#nominee_data").serialize()+"&nominee_relation="+$("#nominee_relation").val()+"&nominee_dob="+$('#nomineedob').val()+"&nominee_salutation="+$("#nominee_salutation").val()+"&nominee_contact="+$('#nominee_contact').val()+"&nominee_email="+$("#nominee_email").val();$.ajax({url:"/tele_nominee_data_insert",type:"POST",data:all_data,async:false,dataType:"json",beforeSend:function(){set_session();},success:function(response){}});proposal_submit_data();}});function proposal_submit_data()
{var emp_agent_data=$("#emp_agent_data").serializeArray();var TableData=[];var LabelData=[];$('#mydatas tr').each(function(row,tr)
{var LabelData={};var label_content;var tds=$(tr).find('td:eq(0)').text();var label=$(tr).find('.label_id').text();var content=$(tr).find('.mycontent').val();var mylabel=$(tr).find('.mycontents').val();var mylabval=$(tr).find('.mylabval').val();if(label!='')
{LabelData=mylabel+':'+mylabval;}
else
{LabelData=mylabval;}
TableData[row]={"question":content,"format":$("#mydatas input[type='checkbox']:checked").val(),"label":LabelData}});var remarks='';if($("#plan_name").val()=='T01'){remarks=$(".myremark").val();}
if($("#plan_name").val()=='T03'||$("#plan_name").val()=='T01'||$("#plan_name").val()=='R06'){remarks='';var select_mem_length=$('.count_sr_ghd_infi').length;var remark_arr=[];for(var lp=0;lp<select_mem_length;lp++){var ghd_hfi_select_val=$("input[type='radio'][name='ghd_mem_radio_"+lp+"']:checked").attr("data");var ghd_hfi_relation_code=$("input[type='radio'][name='ghd_mem_radio_"+lp+"']:checked").attr("data-rc");var ghd_hfi_select_val_ans=$("input[type='radio'][name='ghd_mem_radio_"+lp+"']:checked").val();var ghd_hfi_text_val=$("#ghd_mem_text_"+lp).val();remark_arr.push({member:ghd_hfi_select_val,ans:ghd_hfi_select_val_ans,remark:ghd_hfi_text_val,relation_code:ghd_hfi_relation_code});}
remarks=JSON.stringify(remark_arr);remarks=remarks.replace(/"/g,'\\"');}
var form=$("#proposal_data").serialize()+"&declares="+JSON.stringify(TableData)+"&product_id="+$("#plan_name").val()+"&remarks_new="+remarks;set_session();$.post("/tele_proposal_validation",form,function(e)
{var res=JSON.parse(e);if(res.status==false)
{ajaxindicatorstop();swal({title:"Alert",text:res.message,type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){});return;}
if(res.status==true)
{if($("#plan_name").val()=='T01'||$("#plan_name").val()=='T03'){var plan_name_pass=$("#plan_name").val();$('#summaryForm').attr('action',"/tele_summary?product_id="+plan_name_pass+"&leadid="+$('#hidden_lead_id').val()).submit();}else{$('#summaryForm').attr('action',"/tele_summary?leadid="+$('#hidden_lead_id').val()).submit();}}});}
$.validator.addMethod("time_validate",function(value,element){var preferred_contact_time=$("#preferred_contact_time").val();if(preferred_contact_time){var parts=value.split(':');if(parts[0]==''||parts[1]==''){return false;}
if(parts[0]>23||parts[1]>59){return false;}
return true;}
return true;},"Invalid time format.");$.validator.addMethod
("valid_mobile",function(value,element,param)
{var re=new RegExp("^[6-9][0-9]{9}$");return this.optional(element)||re.test(value);},"Enter a valid 10 digit mobile number and starting from 6 to 9");$("#annual_income").keyup(function(e)
{var $th=$(this);if(e.keyCode!=46&&e.keyCode!=8&&e.keyCode!=37&&e.keyCode!=38&&e.keyCode!=39&&e.keyCode!=40)
{$th.val($th.val().replace(/[^0-9]/g,function(str){return"";}));}});$("#mobile_no2").keyup(function(e)
{var $th=$(this);if(e.keyCode!=46&&e.keyCode!=8&&e.keyCode!=37&&e.keyCode!=38&&e.keyCode!=39&&e.keyCode!=40)
{$th.val($th.val().replace(/[^0-9]/g,function(str){return"";}));}});$("#nominee_contact").keyup(function(e)
{var $th=$(this);if(e.keyCode!=46&&e.keyCode!=8&&e.keyCode!=37&&e.keyCode!=38&&e.keyCode!=39&&e.keyCode!=40)
{$th.val($th.val().replace(/[^0-9]/g,function(str){return"";}));}});$("#pin_code").keyup(function(e)
{var $th=$(this);if(e.keyCode!=46&&e.keyCode!=8&&e.keyCode!=37&&e.keyCode!=38&&e.keyCode!=39&&e.keyCode!=40)
{$th.val($th.val().replace(/[^0-9]/g,function(str){return"";}));}
$("#city").val('');$("#state").val('');if($("#pin_code").val().length!=6){return;}
var pincode=$(this).val();$.ajax({url:"/axis_pincode_get_state_city",type:"POST",async:false,data:{'pincode':pincode},dataType:"json",beforeSend:function(){set_session();},success:function(response)
{if(response!=null){if(response.city!=null&&response.state!=null)
{$("#city").val(response.city);$("#state").val(response.state);}}else{if($("#pin_code").val().length==6){swal("","Invalid Pincode","warning");$("#pin_code").val('');}}}});});$.validator.addMethod
("validate_pincode",function(value,element,param)
{var regs=/^\d{6}$/g;return this.optional(element)||regs.test(value);},"Enter a valid Pin Code");$("body").on("keyup",".first_name",function(e)
{var $th=$(this);if(e.keyCode!=46&&e.keyCode!=8&&e.keyCode!=37&&e.keyCode!=38&&e.keyCode!=39&&e.keyCode!=40)
{$th.val($th.val().replace(/[^A-Za-z ]/g,function(str){return"";}));}
return;});$("body").on("keyup",".last_name",function(e)
{var $th=$(this);if(e.keyCode!=46&&e.keyCode!=8&&e.keyCode!=37&&e.keyCode!=38&&e.keyCode!=39&&e.keyCode!=40)
{$th.val($th.val().replace(/[^A-Za-z ]/g,function(str){return"";}));}
return;});$('body').on("keyup","#comAdd2,#comAdd,#comAdd3",function(){var $th=$(this);$th.val($th.val().replace(/[{}"\\]/g,function(str){return"";}));});jQuery.validator.addMethod("checkspace_nominee",function(value,element,params){var z=value.trim();if(!z){return false;}
return true;});$("#mob_no").keyup(function(e)
{var $th=$(this);if(e.keyCode!=46&&e.keyCode!=8&&e.keyCode!=37&&e.keyCode!=38&&e.keyCode!=39&&e.keyCode!=40)
{$th.val($th.val().replace(/[^0-9]/g,function(str){return"";}));}
return;});$.validator.addMethod("validateEmail",function(value,element,param){if(value.length==0){return true;}
var reg=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return reg.test(value);},"Please enter a valid Email ID. Correct Customer Email ID is mandatory to process further.");function salutation_hide_show(selectChange,gender)
{if(gender=='Male')
{selectChange.find('.female_gen').prop('disabled',true);selectChange.find('.female_gen').hide();selectChange.find('.male_gen').prop('disabled',false);selectChange.find('.male_gen').show();}
else if(gender=='Female')
{selectChange.find('.female_gen').prop('disabled',false);selectChange.find('.female_gen').show();selectChange.find('.male_gen').prop('disabled',true);selectChange.find('.male_gen').hide();}}
$(document).on("blur","#agent_id",function()
{$("#tl_id").val('');$("#tl_name").val('');$("#agent_name").val('');$("#imd_code").val('');$("#axis_lob option:selected").removeAttr("selected");$("#axis_location option:selected").removeAttr("selected");$("#axis_vendor option:selected").removeAttr("selected");var agent_code=$(this).val();var axis_process=$('#saxis_process').val();$.ajax({url:"/tele_agent_details",type:"POST",async:false,data:{agent_id:agent_code,axis_process:axis_process},dataType:"json",beforeSend:function(){set_session();},success:function(response)
{if(response!==null&&response!=='')
{if(response.tl_name!=null){var tl_name=response.tl_name.toUpperCase();}else{var tl_name='';}
$("#tl_id").val(response.tl_emp_id);$("#tl_name").val(tl_name);$("#tl_id").val(response.tl_emp_id);$("#agent_name").val(response.base_agent_name.toUpperCase());$("#imd_code").val(response.imd_code);setTimeout(function(){$("#axis_lob option:contains("+response.lob+")").attr("selected",true);});$('#axis_location option:contains('+response.center+')').each(function(){if($(this).text()==response.center){$(this).prop('selected','selected');return false;}
return true;});$("#axis_location").trigger('change');setTimeout(function(){$("#axis_vendor option:contains("+response.vendor+")").attr("selected",true);$("#axis_vendor").trigger('change');},2000);}else{$("#tl_id").val('');$("#tl_name").val('');$("#agent_name").val('');$("#imd_code").val('');$("#axis_lob option:selected").removeAttr("selected");$("#axis_location option:selected").removeAttr("selected");$("#axis_vendor option:selected").removeAttr("selected");}}});});$.validator.addMethod("validate_agent",function(value,element,param){var count=1;if($("#agent_id").val().length>=1){var agent_id=$("#agent_id").val();var axis_process=$('#saxis_process').val();$.ajax({url:"/tele_agent_details",type:"POST",async:false,data:{agent_id:agent_id,axis_process:axis_process},dataType:"json",success:function(response){if(response!=null&&response!=''){count=0;}else{count=1;}}});}
else
{count=1;}
if(count==1){$("#tl_id").val('');$("#tl_name").val('');$("#tl_id").val('');$("#am_id").val('');$("#am_name").val('');$("#om_id").val('');$("#om_name").val('');$("#agent_name").val('');return false;}else{return true;}},"Base Agent Id Is not available in master.");function ghd_data(e)
{var id=$(e).val();var c1=$('#C1_2:checked').val();var c2=$('#C2_2:checked').val();var d1=$('#D1_2:checked').val();var d2=$('#D2_2:checked').val();var d3=$('#D3_2:checked').val();var d4=$('#D4_2:checked').val();if(d1=='D1_No'&&d2=='D2_No'&&d3=='D3_No'&&d4=='D4_No')
{$("#E_data").show();}
if(id=='B_No')
{$("#B_remark").hide();$(".B").hide();$(".C1").hide();$(".C2").hide();$(".D1").hide();$(".D2").hide();$(".D3").hide();$(".D4").hide();$("#C_data").show();$("#D_data").hide();$("#E_data").hide();$("#C1_remark").hide();$("#C2_remark").hide();$("#D1_remark").hide();$("#D2_remark").hide();$("#D3_remark").hide();$("#D4_remark").hide();$("#C1_1").prop('checked',false);$("#C1_2").prop('checked',false);$("#C2_1").prop('checked',false);$("#C2_2").prop('checked',false);$("#D1_1").prop('checked',false);$("#D1_2").prop('checked',false);$("#D2_1").prop('checked',false);$("#D2_2").prop('checked',false);$("#D3_1").prop('checked',false);$("#D3_2").prop('checked',false);$("#D4_1").prop('checked',false);$("#D4_2").prop('checked',false);$("#E_1").prop('checked',false);$("#E_2").prop('checked',false);}
if(c1=='C1_No'&&id=='C2_No'||c2=='C2_No'&&id=='C1_No')
{$("#D_data").show();$("#D1_remark").hide();$("#D2_remark").hide();$("#D3_remark").hide();$("#D4_remark").hide();$("#E_remark").hide();$("#E_data").hide();$("#E_1").prop('checked',false);$("#E_2").prop('checked',false);}
if(id=='B_Yes')
{$("#B_remark").show();$("#E_remark").hide();$("#D1_remark").hide();$("#D2_remark").hide();$("#D3_remark").hide();$("#D4_remark").hide();$("#C1_remark").hide();$("#C2_remark").hide();$(".C1").hide();$(".C2").hide();$(".D1").hide();$(".D2").hide();$(".D3").hide();$(".D4").hide();$(".E1").hide();$("#E_data").hide();$("#C_data").hide();$("#D_data").hide();$("#C1_1").prop('checked',false);$("#C1_2").prop('checked',false);$("#C2_1").prop('checked',false);$("#C2_2").prop('checked',false);$("#D1_1").prop('checked',false);$("#D1_2").prop('checked',false);$("#D2_1").prop('checked',false);$("#D2_2").prop('checked',false);$("#D3_1").prop('checked',false);$("#D3_2").prop('checked',false);$("#D4_1").prop('checked',false);$("#D4_2").prop('checked',false);$("#E_1").prop('checked',false);$("#E_2").prop('checked',false);}
if(d1!='D1_No'||d2!='D2_No'||d3!='D3_No'&&d4!='D4_No')
{$("#E_data").hide();$(".E1").hide();$("#E_remark").hide();$("#E_1").prop('checked',false);$("#E_2").prop('checked',false);}
if(id=='E_Yes')
{$("#E_remark").show();}
if(id=='E_No')
{$("#E_remark").hide();$(".E").hide();}
if(id=='D1_Yes')
{$("#D1_remark").show();$("#E_data").hide();}
if(id=='D1_No')
{$("#D1_remark").hide();$(".D1").hide();}
if(id=='D2_Yes')
{$("#D2_remark").show();$("#E_data").hide();}
if(id=='D2_No')
{$("#D2_remark").hide();$(".D2").hide();}
if(id=='D3_Yes')
{$("#D3_remark").show();$("#E_data").hide();}
if(id=='D3_No')
{$("#D3_remark").hide();$(".D3").hide();}
if(id=='D4_Yes')
{$("#D4_remark").show();$("#E_data").hide();}
if(id=='D4_No')
{$("#D4_remark").hide();$(".D4").hide();}
if(id=='C2_No')
{$("#C2_remark").hide();$(".C2").hide();}
if(id=='C1_No')
{$("#C1_remark").hide();$(".C1").hide();}
if(id=='C1_Yes')
{$("#C1_remark").show();$("#D_data").hide();$("#E_data").hide();$("#E_remark").hide();$("#D1_remark").hide();$("#D2_remark").hide();$("#D3_remark").hide();$("#D4_remark").hide();$(".D1").hide();$(".D2").hide();$(".D3").hide();$(".D4").hide();$(".E1").hide();$("#D1_1").prop('checked',false);$("#D1_2").prop('checked',false);$("#D2_1").prop('checked',false);$("#D2_2").prop('checked',false);$("#D3_1").prop('checked',false);$("#D3_2").prop('checked',false);$("#D4_1").prop('checked',false);$("#D4_2").prop('checked',false);$("#E_1").prop('checked',false);$("#E_2").prop('checked',false);}
if(id=='C2_Yes')
{$("#C2_remark").show();$("#D_data").hide();$("#E_data").hide();$("#E_remark").hide();$("#D1_remark").hide();$("#D2_remark").hide();$("#D3_remark").hide();$("#D4_remark").hide();$(".D1").hide();$(".D2").hide();$(".D3").hide();$(".D4").hide();$(".E1").hide();$("#D1_1").prop('checked',false);$("#D1_2").prop('checked',false);$("#D2_1").prop('checked',false);$("#D2_2").prop('checked',false);$("#D3_1").prop('checked',false);$("#D3_2").prop('checked',false);$("#D4_1").prop('checked',false);$("#D4_2").prop('checked',false);$("#E_1").prop('checked',false);$("#E_2").prop('checked',false);}}
function get_sub_disposition(data){var sub_disposition=$('option:selected',data).text().replace(/ /g,"_");$("#sub_isposition").prop("disabled",false);$("#sub_isposition").val('');$('[name=show_hide_sub_dispositions]').hide();$("."+sub_disposition).show();if(sub_disposition=='Payment_pending'||sub_disposition=='Payment_done'){$('#pre_send').hide();if(proposal_payment_done==0){proposal_create_check();}}else{$('#hidden_agent_section').val('1');$('#hidden_customer_section').val('1');$('#hidden_nominee_section').val('1');$('#hidden_payment_section').val('1');$('#hidden_policy_section').val('1');$('#hidden_payment_section').val('1');$('#pre_send').show();}
if(($("#disposition").val())=='29'){$(".follow_up_req").html('*');}else{$(".follow_up_req").html('');}}
function proposal_create_check()
{debugger;$.ajax({url:"/tele_proposal_created",type:"POST",async:false,dataType:"json",success:function(response)
{if(response.proposal_status=='Yes'){$("#emp_agent_data").css('pointer-events','none');$("#firstname").attr("readonly",false);$("#lastname").attr("readonly",false);$("#plan_name").css('pointer-events','none');$("#sum_insures").css('pointer-events','auto');$("#occupation").css('pointer-events','none');$("#patFamilyConstruct").css('pointer-events','auto');$("#annual_income").attr("readonly",false);$('input[name=GCI_optional]').attr("disabled",true);$(".del_btn_member").hide();proposal_created=1;show_popup_new=0;}else{$("#emp_agent_data").css('pointer-events','auto');$("#firstname").attr("readonly",true);$("#lastname").attr("readonly",true);$("#plan_name").css('pointer-events','auto');$("#sum_insures").css('pointer-events','auto');$("#occupation").css('pointer-events','auto');$("#patFamilyConstruct").css('pointer-events','auto');$("#annual_income").attr("readonly",false);$('input[name=GCI_optional]').attr("disabled",false);$(".hide_proposal").show();proposal_created=0;}
if(response.status=='Yes')
{proposal_payment_done=1;$("#edit_btn_custsection").hide();$("#edit_nominee").hide();$("#edit_payment").hide();$("#patFormSubmit").hide();$(".hide_proposal").hide();$("#av_remark").val(response.audit_data.remarks);$(".del_p").hide();$("#agent_detail").hide();$("#update_emp").hide();$("#submit_nominee").hide();$("#payment_submit").hide();$("#disposition option:contains('Payment pending')").attr("selected",true);$("#disposition").trigger('change');$("#sub_isposition").val(45);$("#sub_isposition").trigger('change');$("#av_remark").addClass('ignore');payment_details_submit=false;agent_cust_prefilled(response);$('#confr1').hide();}
else
{proposal_payment_done=0;$("#av_remark").val('');$(".hide_proposal").show();if(response.proposal_status=='Yes'){$(".del_btn_member").hide();}
agent_cust_prefilled(response);$("#patFormSubmit").show();$(".del_p").show();$('#confr1').show();$("#agent_detail").show();$("#submit_nominee").show();hideEditButtons();$("#payment_submit").show();hideEditButtons();$("#av_remark").removeClass('ignore');}
if(response.emp_details.GCI_optional=='No'){$('#GCI_no').prop('checked',true);}else{$('#GCI_yes').prop('checked',true);}}});var boxlen=$('.commonCls').length;if(boxlen>0){$("#plan_name").attr('disabled','disabled');if($('#plan_name').val()=='T03'){$("#sum_insures").attr("disabled","disabled");$("#patFamilyConstruct").attr("disabled","disabled");}}
if($("#plan_name").val()=='T01'){$('.GCIOptionalDiv').show();}else{$('.GCIOptionalDiv').hide();}}
function agent_cust_prefilled(response)
{var emp=response.base_agent_details;var axis_det=response.axis_details;if(axis_det!=null&&emp!=null)
{$('#axis_lob').val(emp.axis_lob);$('#axis_vendor').html('<option value ="'+emp.axis_vendor+'" selected>'+axis_det.axis_vendor+'</option>');if(emp.new_remarks!=0){$(".myremark").val(emp.new_remarks);}else{$(".myremark").val('');}
var product_id=response.emp_details.product_id;if((product_id=="T03"||product_id=="T01"||product_id=='R06')&&(emp.new_remarks)){var new_remarks=emp.new_remarks;var new_remarks=new_remarks.replace(/\\/g,"");$.each(JSON.parse(new_remarks),function(index,value){var m=value['member'];var a=value['ans'];var r=value['remark'];$('input:radio[name="ghd_mem_radio_'+index+'"]').filter('[value="'+a+'"]').attr('checked',true);if(a=='yes'){$('#ghd_mem_text_'+index).show();}
$('#ghd_mem_text_'+index).val(r);});}
$('#imd_code').val(emp.imd_code);$('#axis_location').val(emp.axis_location);$('#agent_id').val(emp.base_agent_id);$('#agent_name').val(emp.base_agent_name.toUpperCase());$("#axis_process").html("<option value="+emp.axis_process+" seleccted>"+emp.axis_process+"</option>");$("#comAdd2").val(emp.comm_address);$("#dobdate").val(emp.preferred_contact_date);$("#preferred_contact_time").val(emp.preferred_contact_time);$("#av_remark").val(emp.av_remark);$("#comAdd3").val(emp.comm_address1);$("#mobile_no2").val(emp.emg_cno);$('#tl_id').val(emp.tl_emp_id);$('#tl_name').val(emp.tl_name.toUpperCase());if(emp.base_agent_id!=''){$("#hidden_agent_section").val(1);}
$('#imd_code').val(emp.imd_code);}
var nominee=response.nominee_data;if(nominee!=null){$('#nominee_relation').val(nominee.fr_id);$('#nominee_fname').val(nominee.nominee_fname.toUpperCase());$('#nominee_lname').val(nominee.nominee_lname.toUpperCase());$('#nominee_gender').val(nominee.nominee_gender);$('#nominee_contact').val(nominee.nominee_contact);$('#nominee_email').val(nominee.nominee_email);$('#nomineedob').val(nominee.nominee_dob);$('#nominee_salutation').val(nominee.nominee_salutation);$("#hidden_nominee_section").val(1);if(proposal_payment_done==0){$('#edit_nominee').show();hideEditButtons();}
$('#nominee_relation').attr('disabled',true);$('#nominee_fname').attr('readonly',true);$('#nominee_lname').attr('readonly',true);$('#nominee_salutation').attr('disabled',true);$('#nominee_gender').attr('readonly',true);$('#nomineedob').attr('readonly',true);$('#nomineedob').attr('disabled',true);$('#nominee_contact').attr('readonly',true);$('#nominee_email').attr('readonly',true);}
var ghd=response.ghd_proposer;var len=ghd.length;var i;for(i=0;i<len;i++)
{var member=ghd[i];if(member.type=='C1')
{$("#C_data").show();}
if(member.type=='D1')
{$("#D_data").show();}
if(member.type!='')
{$("#"+member.type+"_data").show();if(member.format=='Yes')
{$("#"+member.type+"_1").prop("checked",true);$("#"+member.type+"_remark").show();$("#"+member.type+"_remark").val(member.remark);}
else
{$("#"+member.type+"_2").prop("checked",true);$("#"+member.remark+"_remark").css('display','none');}}}
var declare_data=response.emp_declare;var lens=declare_data.length;for(i=0;i<lens;i++)
{var declare=declare_data[i];$('input:radio[name="'+declare.p_declare_id+'"][value="'+declare.format+'"]').attr('checked',true);}}
$("#nominee_contact").keyup(function(){if($(this).val().match(/[^0-9]/g))
{$(this).val($(this).val().replace(/[^0-9]/g,""));}});function annual_income_hide_show(sum_insured)
{if($('#plan_name').val()=='T03'){if($('#hidden_policy_id').val()==TELE_HEALTHPROINFINITY_GHI_GPA){$("#annual_income_label").show();var sumInsuresValue=$("#sum_insures :selected").val();var isSumAssuredMoreThan=1000000;if(sumInsuresValue>isSumAssuredMoreThan)
{$("#annual_income_label").show();$("#occupation_label").show();$("#occupation").removeClass('ignore');$("#annual_income").removeClass('ignore');}
else
{$("#annual_income_label").hide();$("#annual_income").addClass('ignore');$("#occupation_label").addClass('ignore');$("#occupation_label").hide();}
if(is_self_purchased==1){$("#annual_income_label").show();$("#annual_income").addClass('ignore');$("#occupation").addClass('ignore');$("#occupation_label").show();}}else{$("#annual_income_label").hide();$("#annual_income").addClass('ignore');$("#occupation_label").hide();$("#occupation").addClass('ignore');}}else{var sumInsuresValue=$("#sum_insures :selected").val();var isSumAssuredMoreThan=1000000;if(sumInsuresValue>isSumAssuredMoreThan)
{$("#annual_income_label").show();$("#occupation_label").show();$("#occupation").removeClass('ignore');}
else
{$("#annual_income_label").hide();$("#occupation_label").hide();$("#annual_income").addClass('ignore');$("#occupation").addClass('ignore');}}}
function apply_button(){if(show_popup==0){var edit=$("#patFamilyConstruct").closest("form").find("input[name='edit']").val();var GCI_optional;var sumInsuresValue=$("#sum_insures :selected").val();var annualIncome=$("#annual_income").val();var patFamilyConstruct=$("#patFamilyConstruct").val();var sum_annual;if(sumInsuresValue=='')
{swal("Alert","Please select Sum Insure");$("#patFamilyConstruct").val('');return;}
if(sumInsuresValue>=1500000){if(annualIncome!=''&&annualIncome!=0)
{sum_annual=annual_income_logic();if(sum_annual==false){return;}}else{return;}}else{annual_income_hide_show();}
$.ajax({url:"tele_apply_changes",type:"POST",data:{'product_id':$('#plan_name').val(),'family_construct':$('select[name=familyConstruct]').val(),'sum_insured':$('select[name=sum_insure]').val(),'gci':$('input[name=GCI_optional]:checked').val(),},async:false,dataType:"json",success:function(response){if(apply_onload>1)
{if(response.message){swal("Alert",response.message);}}
else
{apply_onload++;}}});}}
function annual_income_logic()
{if($("#plan_name").val()=='T03'){if($('#hidden_policy_id').val()!=TELE_HEALTHPROINFINITY_GHI_GPA){return true;}else{if(is_self_purchased==1){return true;}}}
var dropdown_sumIsured;var annual_income=$("#annual_income").val();var sumInsuresValue=$("#sum_insures :selected").val();var ComparesumInsures=$("#sum_insures").val();var IncomeSum=annual_income*8;var sumInsuresValues=(sumInsuresValue/8);var count=0;var plan_name=$("#plan_name").val();if(plan_name=='T03'){var RiskClass=$("#occupation").find(':selected').data('class');if(RiskClass=="RS001"){var IncomeSum=annual_income*10;var sumInsuresValues=(sumInsuresValue/10);}else{var IncomeSum=annual_income*8;var sumInsuresValues=(sumInsuresValue/8);}}
if(sumInsuresValue>1000000)
{if(annual_income==''&&annual_income==0)
{swal("Alert","Annual Income Cannot Be blank","warning");count=1;return false;}
$("#sum_insures option").filter(function(e1){dropdown_sumIsured=$(this).val();if(IncomeSum<sumInsuresValue){swal("Alert","Request to select SI lesser than opted","warning");count=1;$('#annual_income').focus();return false;$("#premiumModalBody").html('');}});}
if(count==1)
{return false;}
else
{insert_annual_income('',annual_income,true);return true;}}
function insert_annual_income(emp_id,annual_income,insert){$.ajax({url:"/tele_update_annual_income",type:"POST",async:false,data:{emp_id:emp_id,annual_income:annual_income,insert:insert},success:function(response){console.log(response);if(response){$("#annual_income").val(response);var annual_income_data=response;if($("#patForm").find("table tbody").children().length!=0)
{}
else
{}}}});}
$.ajax({url:"tele_gpa_policy_purchased_for_self",type:"POST",async:false,dataType:"json",success:function(response){debugger;if($("#plan_name").val()=='T01'||$("#plan_name").val()=='T03'){if(response.flag){is_self_purchased=response.flag;self_purcased_with_si=response.sum_insure;}
if(is_self_purchased==1){$('#occupation').addClass('ignore');$('#annual_income').addClass('ignore');}}}});$(document).ready(function()
{debugger;var is_maker_checker=$("#hidden_is_maker_checker").val();var is_maker_checker_edit=$('#checker_edit').val();if(is_maker_checker=="yes"||is_maker_checker_edit=="yes"){$("#disposition").val('');$("#disposition").attr('disabled',false);$("#sub_isposition").val('');$('#email').attr('readonly',false);$('#email').removeClass("dis-col");var base_agent_id=$("#hidden_base_caller_id").val();var base_agent_lob=$("#hidden_base_caller_lob").val();var base_agent_center=$("#hidden_base_caller_center").val();var base_agent_vendor=$("#hidden_base_caller_vendor").val();var base_agent_name=$("#hidden_base_caller_name").val();var base_tl_id=$("#hidden_base_caller_tl_id").val();var base_tl_name=$("#hidden_base_caller_tl_name").val();var base_imd=$("#hidden_base_caller_imd").val();$("#agent_id").val(base_agent_id);$("#agent_id").css('pointer-events','none');$("#axis_location").val(base_agent_center);$("#axis_lob").val(base_agent_lob);$("#agent_name").val(base_agent_name);$("#tl_id").val(base_tl_id);$("#imd_code").val(base_imd);$("#tl_name").val(base_tl_name);$("#axis_location").trigger("change");$("#axis_vendor").val(base_agent_vendor);$("#plan_name > option").each(function(){var text1=$(this).text();if(text1=="Group Activ Health-Tele"){$(this).text(text1.replace('Group Activ Health-Tele','Group Activ Health'));}
if(text1=='Tele - Health Pro Infinity'){$(this).text(text1.replace('Tele - Health Pro Infinity','Health Pro Infinity'));}});if(is_maker_checker_edit=="yes"){$('input[name="dob"]').addClass("dis-col");$.ajax({url:proposal_create_check(),success:function(){$('.family_date_birth').addClass("dis-col");$("#emp_data :input").prop("readonly",true);}});$(document).on("click","#edit_btn_custsection",function(){$('#edit_btn_custsection').hide();$('#email').attr('readonly',false);$('#email').removeClass("dis-col");});}else{$.ajax({url:proposal_create_check(),success:function(){}});}}});$(document).on('click','#pre_send',function(){$('.bs-example-modal').modal('show');});$(document).on('click','#submit_remark',function(){var remark=$('#send_remark').val();var remark_lead=$('#remark_lead').val();var remark_emp_id=$('#remark_emp_id').val();var remark_agent_name=$('#remark_agent_name').val();var pddisposition=$('#disposition').val();$.ajax({url:'/save_maker_checker_remark',type:'post',dataType:'json',data:{remark:remark,remark_lead:remark_lead,remark_emp_id:remark_emp_id,remark_agent_name:remark_agent_name,pddisposition:pddisposition},success:function(response){if(response.status==1){swal({title:"Success",text:"Submitted Successfully",type:"success",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false},function(){$('#send_remark').val('');$('.bs-example-modal').modal('hide');location.replace('maker_checker_view');});}else{swal({title:"Alert",text:response.message,type:"warning",showCancelButton:false,confirmButtonText:"Ok!",closeOnConfirm:true,allowOutsideClick:false,closeOnClickOutside:false,closeOnEsc:false,dangerMode:true,allowEscapeKey:false});}}});});$(document).ready(function()
{$("#plan_name > option").each(function(){var text1=$(this).text();if(text1=="Group Activ Health-Tele"){$(this).text(text1.replace('Group Activ Health-Tele','Group Activ Health'));}
if(text1=='Tele - Health Pro Infinity'){$(this).text(text1.replace('Tele - Health Pro Infinity','Health Pro Infinity'));}});});function hideEditButtons(){var hidden_editstatus=atob($("#hidden_editstatus").val());console.log(hidden_editstatus);if(hidden_editstatus=='0'){$('.editBtn').hide();}}
